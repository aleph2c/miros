
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cellular Automata &#8212; miros 2.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Active Object Example" href="singlechartexample.html" />
    <link rel="prev" title="Comprehensive" href="comprehensive.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <blockquote>
<div><p><em>Making the simple complicated is commonplace; making the complicated simple, awesomely simple, that’s creativity.</em></p>
<p class="attribution">&mdash;Charlie Mingus</p>
</div></blockquote>
<div class="section" id="cellular-automata">
<h1>Cellular Automata<a class="headerlink" href="#cellular-automata" title="Permalink to this headline">¶</a></h1>
<p>Here is a picture of the predatory snail, <a class="reference external" href="https://www.youtube.com/watch?v=JjHMGSI_h0Q">Conus Textile</a>:</p>
<a class="reference external image-reference" href="https://en.wikipedia.org/wiki/Cellular_automaton#/media/File:Textile_cone.JPG"><img alt="_images/Conus_textile.JPG" class="align-center" src="_images/Conus_textile.JPG" /></a>
<div class=body>By Richard Ling - Own work; Location: Cod Hole, Great Barrier Reef, Australia, <a href="http://creativecommons.org/licenses/by-sa/3.0/" title="Creative Commons Attribution-Share Alike 3.0">CC BY-SA 3.0</a>, <a href="https://commons.wikimedia.org/w/index.php?curid=293495">Link</a></div><p>The pattern on its shell is an example of a 1D cellular automata.  The shell is
grown by a kind of organic line of printer heads along the shell’s lip.  These
printer heads, called pigment cells, can extrude colored calcium cement.  The
color choice of a pigment cell is dependent upon the color choice of it’s two
adjacent pigment cells.  The rules governing this process are simple, yet a very
complex shell color pattern emerges.</p>
<p>A 1D cellular automata exists on a 2D grid of cells; like graphing paper, and it
is governed by a simple set of rules.  How you color in a square is dependent
upon the coloring of the three squares above it.  If we decided only to use
black and white coloring, a square’s color would be dependent upon eight
different permutations of the three squares above it.  The governing rules of a
1D cellular automata could be described by drawing out these eight pictures.</p>
<p>But before we begin to fill in our drawings we would have to decide how to start
them.  Typically you color the middle square of the top line on your graphing
paper black, then begin painting the squares of the second line using the rules.
Of course, you don’t have to do this, you can start however you like.  But how
you start is called the initial condition, and as you will see, the initial
conditions have a huge effect on the overall emergent pattern of your drawing.</p>
<p>In 1983 <a class="reference external" href="https://www.youtube.com/watch?v=60P7717-XOQ">Stephen Wolfram</a>
discovered a 1D cellular automata which created patterns that look like the
shell of the Conus Textile snail.  He called this program, <a class="reference external" href="https://en.wikipedia.org/wiki/Rule_30">Rule 30</a>.</p>
<p>Let’s explore how to make a Rule 30, 1D cellular automata, by looking at the
instructions which govern it:</p>
<blockquote>
<div><em>“First, look at each cell and it’s right-hand neighbor.  If both of these were
white on the previous step, then take the new color of the cell to be whatever
the previous color of its left-hand neighbor was.  Otherwise, take the new
color to be the opposite of that.”</em> <a class="footnote-reference" href="#id2" id="id1">[1]</a></div></blockquote>
<p>Here are these instructions as a picture:</p>
<a class="reference external image-reference" href="_static/rule_30_rule_in_pictures.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_rule_in_pictures.svg" src="_images/rule_30_rule_in_pictures.svg" /></div>
</a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you look carefully at the picture version of the rule, you will see two
rows of binary numbers, and the reason why rule 30 is called rule 30.</p>
</div>
<p>Now let’s start a drawing: we will place a black square in the middle of the
first line then follow the rules to fill in the 4 lines below it.</p>
<a class="reference external image-reference" href="_static/rule_30_by_hand.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_by_hand.svg" src="_images/rule_30_by_hand.svg" /></div>
</a>
<p>If you look at the diagram and compare it to the rules described as a paragraph,
then to the pictures illustrating this same rule, you will see how it works.</p>
<p>Let’s write some Python code that can build something like this.</p>
<p>But before we start, what do we do about the edges of our graphing paper?  We could just pretend
they aren’t there, making the automata infinite.  Or, we could wrap the paper
into a tube so that there is no edge.  Both of these things have been done
before, but I haven’t seen anyone just force a color onto the edge of the
graphing paper, like a wall.  So, let’s do that, let’s build a wall.</p>
<p>This will give us a chance to have two state machines interact in the same
cellular automata.  We need two different machines, a rule 30 machine and a wall
machine.  The wall machine should be able to be white or black.</p>
<p>Let’s design a system, then build it and run it (not necessarily in that order)
and see if we can make something new.</p>
<div class="section" id="high-level-sketches">
<span id="cellular-automata-design"></span><h2>High Level Sketches<a class="headerlink" href="#high-level-sketches" title="Permalink to this headline">¶</a></h2>
<p>Before we start writing our code let’s sketch out some pictures which will help
guide our thinking.  We would like to see:</p>
<ul class="simple">
<li><a class="reference internal" href="#cellular-automata-a-small-example-of-the-automata-running-inside-of-walls"><span class="std std-ref">a small example of the automata running inside of walls.</span></a></li>
<li><a class="reference internal" href="#cellular-automata-a-highlevel-diagram"><span class="std std-ref">a general idea about how to get visual feedback from our code and how that
will relate to our automata.</span></a> (we will figure out the specifics later)</li>
<li><a class="reference internal" href="#cellular-automata-state-machines-needed-to-build-automata"><span class="std std-ref">some drawings of the state machines needed to make the automata.</span></a></li>
</ul>
<div class="section" id="automata-running-inside-of-walls">
<span id="cellular-automata-a-small-example-of-the-automata-running-inside-of-walls"></span><h3>Automata Running Inside of Walls<a class="headerlink" href="#automata-running-inside-of-walls" title="Permalink to this headline">¶</a></h3>
<p>Here is a small example of the rule 30 automata running inside of walls:</p>
<a class="reference external image-reference" href="_static/rule_30_basic_design_0.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_basic_design_0.svg" src="_images/rule_30_basic_design_0.svg" /></div>
</a>
<p>This sketch is a mock-up of the output we would like our code to create.  It also
shows the rules which govern how the picture is made, some terminology and some
examples about how some of the components could be build with Python.</p>
<p>The top of the diagram describes rule 30 in pictures and the main part of the
drawing shows an example of the one dimensional automata we want to build.</p>
<p>The one dimensional automata is made up of individual cells, which will be
governed by two different sets of rules.  A cell can be derived from either a
<code class="docutils literal notranslate"><span class="pre">Rule30</span></code> class which is governed by the rules described at the top of the page
or a <code class="docutils literal notranslate"><span class="pre">Wall</span></code> class, which is given a color to start at and remains in that color
forever.  Once a cell is instantiated, it is started in the color we want it to
appear in on our drawing.  The walls of the diagram are colored orange so that
we can distinguish them from the bulk of the drawing which is made up of rule 30
cells.</p>
<p>We would like our code to be able to run for a programmable number of
<code class="docutils literal notranslate"><span class="pre">generations</span></code>.  A single generation is a row of the one dimensional automata.
The <code class="docutils literal notranslate"><span class="pre">Next</span></code> event, will be used to tell the code representing the diagram, to
build its next generation.</p>
<p>We would also like our code to be able to build any width of cells.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Z</span></code> object represents the 2D binary matrix which will describe our
drawing.  This matrix will be used to analyze our automata as it runs.</p>
</div>
<div class="section" id="high-level-design-diagram">
<span id="cellular-automata-a-highlevel-diagram"></span><h3>High Level Design Diagram<a class="headerlink" href="#high-level-design-diagram" title="Permalink to this headline">¶</a></h3>
<p>Now that we know what kind of output we want, we need to think about how we will
structure a program to give us this output.</p>
<p>We need something that can make our one dimensional cellular automata and we
need some way to look at it.  Let’s call the thing that we will use to visualize
our automata, a canvas.</p>
<p>Our canvas will be given an automata object which it will draw.  Our automata
object will have many rule 30 objects and many wall objects.</p>
<p>Here is what we wrote above, expressed as a UML diagram:</p>
<a class="reference external image-reference" href="_static/rule_30_basic_design_1.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_basic_design_1.svg" src="_images/rule_30_basic_design_1.svg" /></div>
</a>
<p>The <code class="docutils literal notranslate"><span class="pre">Canvas</span></code> class <em>has a</em> <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code> class.  This
<code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code> class <em>has many</em> <code class="docutils literal notranslate"><span class="pre">Rule30</span></code> and <code class="docutils literal notranslate"><span class="pre">Wall</span></code> classes.
Seems simple enough.</p>
<p>Let’s build the <code class="docutils literal notranslate"><span class="pre">Canvas</span></code> class so that it can both draw our diagrams and make
video animations. Let’s make the <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code> responsible for
creating any automata given a <code class="docutils literal notranslate"><span class="pre">Wall</span></code> class and a <code class="docutils literal notranslate"><span class="pre">Rule</span></code> class.</p>
</div>
<div class="section" id="statemachines-needed-to-build-rule-30-in-walls">
<span id="cellular-automata-state-machines-needed-to-build-automata"></span><h3>Statemachines Needed to Build Rule 30 in Walls<a class="headerlink" href="#statemachines-needed-to-build-rule-30-in-walls" title="Permalink to this headline">¶</a></h3>
<p>We have drawn the <code class="docutils literal notranslate"><span class="pre">Rule30</span></code> and <code class="docutils literal notranslate"><span class="pre">Wall</span></code> classes as abstract blocks in the
previous high level diagram. But we know how they work, so let’s re-draw them
now in more detail:</p>
<a class="reference external image-reference" href="_static/rule_30_basic_design_2.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_basic_design_2.svg" src="_images/rule_30_basic_design_2.svg" /></div>
</a>
<p>The state machine under the <code class="docutils literal notranslate"><span class="pre">Rule30</span></code> class will provide the behaviour
described by the squares at the top of the page.  The state machine under the
<code class="docutils literal notranslate"><span class="pre">Wall</span></code> class consists of two states which can only be gotten to using the
<code class="docutils literal notranslate"><span class="pre">start_at</span></code> method, no event will cause a transition between these states.  The
<code class="docutils literal notranslate"><span class="pre">Wall</span></code> objects are intended to interface with the <code class="docutils literal notranslate"><span class="pre">Rule30</span></code> objects so that a
<code class="docutils literal notranslate"><span class="pre">Rule30</span></code> cell can’t tell if it is working with an actual machine or just a
wall.</p>
</div>
</div>
<div class="section" id="design-and-code">
<span id="cellular-automata-design-and-code"></span><h2>Design and Code<a class="headerlink" href="#design-and-code" title="Permalink to this headline">¶</a></h2>
<p>Now that we know what we want to build, let’s make our designs more detailed and
write the Python code required to make the design work.</p>
<div class="section" id="canvas-class">
<span id="cellular-automata-canvas"></span><h3>Canvas Class<a class="headerlink" href="#canvas-class" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Canvas</span></code> class will provide visual feedback.</p>
<p>But, how will we build a <code class="docutils literal notranslate"><span class="pre">Canvas</span></code> class to get the feedback needed to see what is
going on with our program?</p>
<p>If we were using Stephen Wolfram’s Mathematica software, this work would be
trivial. Even if we were using Matlab, it wouldn’t be too hard to see these
automata, but we are using Python so we will have to stitch a few things
together before we can visualize our work.</p>
<p>Let’s go technology shopping.</p>
<p>A few years ago Python <a class="reference external" href="https://www.youtube.com/watch?v=AyenRCJ_4Ww">borg’d</a>
Matlab, into its <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">scipy</span></code> and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> packages, so the Matlab
type interfaces have been assimilated into the Python collective: resistance is
futile.  We can use the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> libraries to get the Matlab
features we need to build and animate our automata.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> library can animate graphs so we will use that.  The graphing
paper look that we want is provided by its <code class="docutils literal notranslate"><span class="pre">matplotlib.pcolormesh</span></code> graphing
object so we will use that too.  Animations are provided by the
<code class="docutils literal notranslate"><span class="pre">matplotlib.FuncAnimation</span></code> class, which takes a reference to the figure you
are drawing on, information about how many frames you want in your movie and how
often you want to show them, and some callback functions that affect the data
(your picture) for each frame.  The callback functions will be very useful,
because it means we can pull the operation of our automata away from the
<code class="docutils literal notranslate"><span class="pre">Canvas</span></code> class and we can make the animation callback call out to a Python
coroutine, so we can run our automata forever (if we wanted that).</p>
<p>Under the hood <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> calls out to <code class="docutils literal notranslate"><span class="pre">FFmpeg</span></code>, which is some open source
software that makes videos.  Let’s install what we need and get back to our
design:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">ffmpeg</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">numpy</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">matplotlib</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I’m assuming you are working within a virtual enviroment.  If you are on
windows, go and get the ubuntu app, and run this code within your Windows
Linux Subsystem (WLS).  If you are on a mac, you can use <code class="docutils literal notranslate"><span class="pre">brew</span></code> to get
ffmpeg.</p>
</div>
<p>Here is a UML drawing of the Canvas class:</p>
<a class="reference external image-reference" href="_static/rule_30_canvas.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_canvas.svg" src="_images/rule_30_canvas.svg" /></div>
</a>
<p>The <code class="docutils literal notranslate"><span class="pre">Canvas</span></code> class will have a <code class="docutils literal notranslate"><span class="pre">FuncAnimation</span></code> object and a
<code class="docutils literal notranslate"><span class="pre">LinearSegmentedColormap</span></code> (used for making colors), and it shows us how we
want to make the object and how we want to use it with the <code class="docutils literal notranslate"><span class="pre">run_animation</span></code> and
<code class="docutils literal notranslate"><span class="pre">save</span></code> methods.</p>
<p>It also shows us that the Canvas calls will have a <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code>
object, which will be created elsewhere, then passed to it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="kn">as</span> <span class="nn">animation</span>

<span class="k">class</span> <span class="nc">Canvas</span><span class="p">():</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">automata</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Animate 2D graphing paper, or static file describing a automata</span>

<span class="sd">    Given an autonoma, which has a ``_Generation`` coroutine generator, an</span>
<span class="sd">    animation can be build by calling this coroutine for as many generations</span>
<span class="sd">    are required.</span>

<span class="sd">    **Note**:</span>
<span class="sd">       This ``automata`` object needs to provide a ``_Generation`` method</span>
<span class="sd">       which returns a coroutine which can be called with ``next``.</span>

<span class="sd">    **Args**:</span>
<span class="sd">       | ``automata`` (OneDCellularAutomata):</span>
<span class="sd">       | ``title=None`` (string): An optional title</span>

<span class="sd">    **Returns**:</span>
<span class="sd">       (Canvas): this object</span>

<span class="sd">    **Example(s)**:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">       eco1 = Canvas(autonoma)</span>
<span class="sd">       eco1.run_animation(1200, interval=10)  # 10 ms</span>
<span class="sd">       eco1.save(&#39;eco1.mp4&#39;)</span>

<span class="sd">       eco2 = Canvas(automata)</span>
<span class="sd">       eco2 = save(&#39;eco2.pdf, generations=100)</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">automata</span> <span class="o">=</span> <span class="n">automata</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generation</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">_Generation</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="c1"># seventies orange/browns looking color map</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span>
      <span class="s1">&#39;oranges&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#ffffff&#39;</span><span class="p">,</span> <span class="s1">&#39;#ffa501&#39;</span><span class="p">,</span> <span class="s1">&#39;#b27300&#39;</span><span class="p">,</span> <span class="s1">&#39;#191000&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generation</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;animation initialization callback</span>

<span class="sd">    **Note**:</span>
<span class="sd">       This not needed by our animation, but it is needed by the library we</span>
<span class="sd">       are calling, so we just stub it out</span>

<span class="sd">    **Returns**:</span>
<span class="sd">       (tuple): (self.grid,)</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">,)</span>

  <span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;animation callback.</span>

<span class="sd">    This method will be called for each i frame of the animation.  It creates</span>
<span class="sd">    the next generation of the automata then it updates the pcolormesh using</span>
<span class="sd">    the set_array method.</span>

<span class="sd">    **Args**:</span>
<span class="sd">       | ``i`` (int): animation frame number</span>

<span class="sd">    **Returns**:</span>
<span class="sd">       (tuple): (self.grid,)</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generation</span><span class="p">)</span>
    <span class="c1"># set_array only accepts a 1D argument</span>
    <span class="c1"># so flatten Z before feeding it into the grid arg</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">,)</span>

  <span class="k">def</span> <span class="nf">run_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generations</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Run an animation of the automata.</span>

<span class="sd">    **Args**:</span>
<span class="sd">       | ``generations`` (int): number of automata generations</span>
<span class="sd">       | ``interval`` (int): movie frame interval in ms</span>

<span class="sd">    **Example(s)**:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">      eco = Canvas(automata)</span>
<span class="sd">      eco.run_animation(1200, interval=20)  # 20 ms</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">animate</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">init</span><span class="p">,</span>
      <span class="n">frames</span><span class="o">=</span><span class="n">generations</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
      <span class="n">blit</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">generations</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;save an animation or run for a given number of generations and save as a</span>
<span class="sd">       static file (pdf, svg, .. etc)</span>

<span class="sd">    **Note**:</span>
<span class="sd">       This function will save as many different static file formats as are</span>
<span class="sd">       supported by matplot lib, since it uses matplotlib.</span>

<span class="sd">    **Args**:</span>
<span class="sd">       | ``filename=None`` (string): name of the file</span>
<span class="sd">       | ``generations=0`` (int): generations to run if the files doesn&#39;t have</span>
<span class="sd">       |                          an &#39;mp4&#39; extension and hasn&#39;t been</span>
<span class="sd">       |                          animated before</span>


<span class="sd">    **Example(s)**:</span>

<span class="sd">       eco1 = Canvas(autonoma)</span>
<span class="sd">       eco1.run_animation(50, 10)</span>
<span class="sd">       eco1.save(&#39;rule_30.mp4)</span>
<span class="sd">       eco1.save(&#39;rule_30.pdf)</span>

<span class="sd">       eco2 = Canvas(autonoma)</span>
<span class="sd">       eco1.save(&#39;rule_30.pdf&#39;, generations=40)</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s1">&#39;.mp4&#39;</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">automata</span><span class="o">.</span><span class="n">generation</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">automata</span><span class="o">.</span><span class="n">generations</span><span class="p">):</span>
          <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">automata</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">On construction: I didn’t write the <code class="docutils literal notranslate"><span class="pre">Canvas</span></code> class out of thin air, I
created a 2 dimensional array and some functions that would randomize this
array, then I fed these functions into the code that I built up using examples
from the internet until I got something working.  Only then did I feed it the
OneDCellularAutomata class, which originally didn’t use a co-routine; it
was added later.</p>
</div>
</div>
<div class="section" id="the-onedcellularautomata-class">
<span id="cellular-automata-two2automato"></span><h3>The OneDCellularAutomata Class<a class="headerlink" href="#the-onedcellularautomata-class" title="Permalink to this headline">¶</a></h3>
<p>Let’s give our basic design another look:</p>
<a class="reference external image-reference" href="_static/rule_30_basic_design.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_basic_design.svg" src="_images/rule_30_basic_design.svg" /></div>
</a>
<p>The <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code> object will be responsible for applying the rules
to our graphing paper, and for setting it into its initial condition (the black
square in the middle of the top line).</p>
<p>To do this <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code> will provide a two-dimensional array, Z,
containing color codes, to be used by our Canvas to draw things.  It also builds
a lot of <code class="docutils literal notranslate"><span class="pre">Rule30</span></code> and <code class="docutils literal notranslate"><span class="pre">Wall</span></code> state machines and links them to other machines
so that they can read the <code class="docutils literal notranslate"><span class="pre">left.color</span></code> and <code class="docutils literal notranslate"><span class="pre">right.color</span></code> attributes of their
adjacent cells.  <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code> needs to set up some initial
conditions; how the machines are started on the first line of our graphing
paper.  The <code class="docutils literal notranslate"><span class="pre">Rule30</span></code> state machines respond to <code class="docutils literal notranslate"><span class="pre">Next</span></code> events, which cause
them to react and change if they need to change, so the <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code>
will need to dispatch this event into all of the <code class="docutils literal notranslate"><span class="pre">Rule30</span></code> objects to make a
new line as the automata propagate downward.</p>
<p>To make the <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code> object generic, we will feed it its
automata rule and wall rules as classes.  To make the wall behaviour
parameterizable, I’ll add some new wall rule classes that hold the left and
right colors in their class attributes:</p>
<a class="reference external image-reference" href="_static/rule_30_basic_design_1.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_basic_design_1.svg" src="_images/rule_30_basic_design_1.svg" /></div>
</a>
<p>Here is a UML diagram of the <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code> class:</p>
<a class="reference external image-reference" href="_static/rule_30_twodcellularautomata.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_twodcellularautomata.svg" src="_images/rule_30_twodcellularautomata.svg" /></div>
</a>
<p>There is a bunch of stuff in this diagram that I don’t know how to draw using
UML.  For instance, how do I show a class that I have sent it a class, so it
knows how to build something, using the class I just gave it?  How do I draw
something that makes a co-routine?</p>
<p>Well, I don’t know, so I will just scribble down something that isn’t too
confusing and explain what I meant here with a few words:</p>
<p>The few key takeaways from the drawing are how the constructor works, we feed it
in the rule and wall classes so that it can generically construct automata.  We
also show the function that returns the co-routine.  Each time <code class="docutils literal notranslate"><span class="pre">next</span></code> is
called it advances to the next yield statement.  So, the first time the
coroutine is activated, it will initialize the automata, and then every
activation after that will cause it to descend one row down.</p>
<p>Here is the code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">Event</span>

<span class="n">White</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Black</span> <span class="o">=</span> <span class="mf">0.9</span>

<span class="k">class</span> <span class="nc">OneDCellularAutomata</span><span class="p">():</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
      <span class="n">generations</span><span class="p">,</span>
      <span class="n">cells_per_generation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
      <span class="n">initial_condition_index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
      <span class="n">machine_cls</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
      <span class="n">wall_cls</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
      <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Build a two dimensional cellular automata object which can be advanced</span>
<span class="sd">       with a coroutine.</span>

<span class="sd">    **Args**:</span>
<span class="sd">       | ``generations`` (int): how many generations to run (vertical cells)</span>
<span class="sd">       | ``cells_per_generation=None`` (int): how many cells across</span>
<span class="sd">       | ``initial_condition_index=None`` (int): the starting index cell (make</span>
<span class="sd">       |                                         black)</span>
<span class="sd">       | ``machine_cls=None`` (Rule): which automata rule to follow</span>
<span class="sd">       | ``wall_cls=None`` (Wall): which wall rules to follow</span>

<span class="sd">    **Returns**:</span>
<span class="sd">       (OneDCellularAutonomata): an automata object</span>

<span class="sd">    **Example(s)**:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">      # build an automata using rule 30 with white walls</span>
<span class="sd">      # it should be 50 cells across</span>
<span class="sd">      # and it should run for 1000 generations</span>
<span class="sd">      autonoma = OneDCellularAutomata(</span>
<span class="sd">        machine_cls=Rule30,</span>
<span class="sd">        generations=1000,</span>
<span class="sd">        wall_cls=WallLeftWhiteRightWhite,</span>
<span class="sd">        cells_per_generation=50</span>
<span class="sd">      )</span>

<span class="sd">      # to get the generator for this automata</span>
<span class="sd">      generation = automata.make_generation_coroutine()</span>

<span class="sd">      # to advance a generation (first one will initialize it)</span>
<span class="sd">      next(generation)</span>

<span class="sd">      # to get the color codes from it&#39;s two dimension array</span>
<span class="sd">      automata.Z</span>

<span class="sd">      # to advance a generation</span>
<span class="sd">      next(generation)</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">machine_cls</span> <span class="o">=</span> <span class="n">machine_cls</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">wall_cls</span> <span class="o">=</span> <span class="n">wall_cls</span>

    <span class="k">if</span> <span class="n">machine_cls</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">machine_cls</span> <span class="o">=</span> <span class="n">Rule30</span>

    <span class="k">if</span> <span class="n">wall_cls</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">wall_cls</span> <span class="o">=</span> <span class="n">WallLeftWhiteRightWhite</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">generations</span> <span class="o">=</span> <span class="n">generations</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cells_per_generation</span> <span class="o">=</span> <span class="n">cells_per_generation</span>

    <span class="c1"># if they haven&#39;t specified cells_per_generation set it</span>
    <span class="c1"># so that the cells appear square on most terminals</span>
    <span class="k">if</span> <span class="n">cells_per_generation</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="c1"># this number was discovered through trial and error</span>
      <span class="c1"># matplotlib seems to be ignoring the aspect ratio</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">cells_per_generation</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">generations</span><span class="o">*</span><span class="mi">17</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">initial_condition_index</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells_per_generation</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> \
      <span class="k">if</span> <span class="n">initial_condition_index</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">initial_condition_index</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">generation</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">left_wall</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wall_cls</span><span class="o">.</span><span class="n">left_wall</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right_wall</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wall_cls</span><span class="o">.</span><span class="n">right_wall</span>

  <span class="k">def</span> <span class="nf">make_and_start_left_wall_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;make and start the left wall based on the wall_cls&#39;&#39;&#39;</span>
    <span class="n">wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall_cls</span><span class="p">()</span>
    <span class="n">wall</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall_cls</span><span class="o">.</span><span class="n">left_wall</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wall</span>

  <span class="k">def</span> <span class="nf">make_and_start_right_wall_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;make and start the right wall based on the wall_cls&#39;&#39;&#39;</span>
    <span class="n">wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wall_cls</span><span class="p">()</span>
    <span class="n">wall</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wall_cls</span><span class="o">.</span><span class="n">right_wall</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wall</span>

  <span class="k">def</span> <span class="nf">initial_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;initialize the 1d cellular automata&#39;&#39;&#39;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">generations</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells_per_generation</span><span class="p">],</span> <span class="n">Black</span><span class="p">,</span>
                <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="c1"># create a collections of unstarted machines</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">machines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells_per_generation</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machine_cls</span><span class="p">())</span>

    <span class="n">left_wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_and_start_left_wall_machine</span><span class="p">()</span>
    <span class="n">right_wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_and_start_right_wall_machine</span><span class="p">()</span>

    <span class="c1"># unstarted machines sandwiched between unstarted boundaries</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">machines</span> <span class="o">=</span> <span class="p">[</span><span class="n">left_wall</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">machines</span> <span class="o">+</span> <span class="p">[</span><span class="n">right_wall</span><span class="p">]</span>

    <span class="c1"># start the boundaries in their holding color</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="n">fake_white</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="n">fake_white</span><span class="p">)</span>

    <span class="c1"># start most of the machines in white except for the one at the</span>
    <span class="c1"># intial_condition_index</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_condition_index</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="n">white</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="n">black</span><span class="p">)</span>

    <span class="c1"># we have created a generation, so count down by one</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generations</span><span class="o">-</span><span class="mi">1</span>

    <span class="c1"># create some initial walls in Z</span>
    <span class="n">Z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">color_number</span><span class="p">()</span>
    <span class="n">Z</span><span class="p">[:,</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">color_number</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span>

  <span class="k">def</span> <span class="nf">next_generation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;create the next row of the 1d cellular automata&#39;&#39;&#39;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generation</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">generations</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="c1"># draw the first row</span>
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">machine</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">):</span>
        <span class="n">Z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">generations</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">color_number</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># draw every other row</span>
      <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span>
      <span class="n">new_machines</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
        <span class="n">old_left_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">old_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">old_right_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">new_machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">machine_cls</span><span class="p">()</span>
        <span class="n">new_machine</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="n">old_machine</span><span class="o">.</span><span class="n">state_fn</span><span class="p">)</span>
        <span class="n">new_machine</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">old_left_machine</span>
        <span class="n">new_machine</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">old_right_machine</span>
        <span class="n">new_machines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_machine</span><span class="p">)</span>

      <span class="n">left_wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_and_start_left_wall_machine</span><span class="p">()</span>
      <span class="n">right_wall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_and_start_right_wall_machine</span><span class="p">()</span>
      <span class="n">new_machines</span> <span class="o">=</span> <span class="p">[</span><span class="n">left_wall</span><span class="p">]</span> <span class="o">+</span> <span class="n">new_machines</span> <span class="o">+</span> <span class="p">[</span><span class="n">right_wall</span><span class="p">]</span>

      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">machine</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_machines</span><span class="p">):</span>
        <span class="n">machine</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="n">signal</span><span class="o">=</span><span class="n">signals</span><span class="o">.</span><span class="n">Next</span><span class="p">))</span>
        <span class="n">Z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">generation</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">color_number</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">machines</span> <span class="o">=</span> <span class="n">new_machines</span><span class="p">[:]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">generation</span> <span class="o">-=</span> <span class="mi">1</span>

  <span class="k">def</span> <span class="nf">make_generation_coroutine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;create the automata coroutine&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="p">()</span>
    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">next_generation</span><span class="p">()</span>
      <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">On construction:  Initially I build the <code class="docutils literal notranslate"><span class="pre">OneDCellularAutomata</span></code> without a
coroutine.</p>
</div>
</div>
<div class="section" id="rule30-and-the-wall-classes">
<span id="cellular-automata-rule30-and-the-walls"></span><h3>Rule30 and the Wall Classes<a class="headerlink" href="#rule30-and-the-wall-classes" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Rule30</span></code> is a class which describes the attributes and methods needed by our
rule30 state machine.   The rule30 state machine really isn’t described anywhere
as an individual entity, it is two callback functions that attach to a
<code class="docutils literal notranslate"><span class="pre">Rule30</span></code> object.  You can see it here:</p>
<a class="reference external image-reference" href="_static/rule_30_basic_design_1.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_basic_design_1.svg" src="_images/rule_30_basic_design_1.svg" /></div>
</a>
<p>To see if the rule 30 machine is designed properly, put your eyes on one of the
clusters-of-four-squares at the top of the diagram.  Now imagine the state
machine was started in the color of the middle of the top three squares of this
cluster.  Send the <code class="docutils literal notranslate"><span class="pre">Next</span></code> event to the machine and see if you can get it to
transition to the color of the bottom square of the cluster.</p>
<p>Let’s do the first one together:</p>
<a class="reference external image-reference" href="_static/rule_30_does_it_work.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_does_it_work.svg" src="_images/rule_30_does_it_work.svg" /></div>
</a>
<p>If you repeat this exercise for each of the cluster-of-four-squares, and you are
satisfied, then this state machine’s design will give us the rule 30 behavior.</p>
<p>The wall is an even simpler machine, it starts in one color state and remains
that way forever.</p>
<p>Here is the code for our <code class="docutils literal notranslate"><span class="pre">Rule30</span></code> and <code class="docutils literal notranslate"><span class="pre">Wall</span></code> classes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">Event</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">signals</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">HsmWithQueues</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">return_status</span>

<span class="k">class</span> <span class="nc">Wall</span><span class="p">(</span><span class="n">HsmWithQueues</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;wall&#39;</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="bp">None</span>

  <span class="k">def</span> <span class="nf">color_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Black</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;black&#39;</span> <span class="k">else</span> <span class="n">White</span>

<span class="k">def</span> <span class="nf">fake_white</span><span class="p">(</span><span class="n">wall</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">wall</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">Next</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">wall</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">wall</span><span class="o">.</span><span class="n">top</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span>
  <span class="k">return</span> <span class="n">status</span>

<span class="k">def</span> <span class="nf">fake_black</span><span class="p">(</span><span class="n">wall</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">wall</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">Next</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">wall</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">wall</span><span class="o">.</span><span class="n">top</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span>
  <span class="k">return</span> <span class="n">status</span>

<span class="k">class</span> <span class="nc">WallLeftWhiteRightWhite</span><span class="p">(</span><span class="n">Wall</span><span class="p">):</span>
  <span class="n">left_wall</span> <span class="o">=</span> <span class="n">fake_white</span>
  <span class="n">right_wall</span> <span class="o">=</span> <span class="n">fake_white</span>

<span class="k">class</span> <span class="nc">WallLeftWhiteRightBlack</span><span class="p">(</span><span class="n">Wall</span><span class="p">):</span>
  <span class="n">left_wall</span> <span class="o">=</span> <span class="n">fake_white</span>
  <span class="n">right_wall</span> <span class="o">=</span> <span class="n">fake_black</span>

<span class="k">class</span> <span class="nc">WallLeftBlackRightWhite</span><span class="p">(</span><span class="n">Wall</span><span class="p">):</span>
  <span class="n">left_wall</span> <span class="o">=</span> <span class="n">fake_black</span>
  <span class="n">right_wall</span> <span class="o">=</span> <span class="n">fake_white</span>

<span class="k">class</span> <span class="nc">WallLeftBlackRightBlack</span><span class="p">(</span><span class="n">Wall</span><span class="p">):</span>
  <span class="n">left_wall</span> <span class="o">=</span> <span class="n">fake_black</span>
  <span class="n">right_wall</span> <span class="o">=</span> <span class="n">fake_black</span>

<span class="k">class</span> <span class="nc">Rule30</span><span class="p">(</span><span class="n">Wall</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;cell&#39;</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">white</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">Next</span><span class="p">):</span>
    <span class="k">if</span><span class="p">((</span><span class="n">cell</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;black&#39;</span> <span class="ow">and</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span> <span class="ow">or</span>
       <span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;white&#39;</span> <span class="ow">and</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;black&#39;</span><span class="p">)):</span>
      <span class="n">status</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">black</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">top</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span>
  <span class="k">return</span> <span class="n">status</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-and-visualizing-the-cellular-automata">
<span id="cellular-automata-running-and-visualizing-the-automata"></span><h2>Running and Visualizing the Cellular Automata<a class="headerlink" href="#running-and-visualizing-the-cellular-automata" title="Permalink to this headline">¶</a></h2>
<p>Now that we have all the parts we need let’s stitch them together and see what
happens.  We will build an automata using rule 30 with some white walls. Then we
will feed the automata into a canvas, and use the canvas to print a <cite>png</cite> file,
a <cite>pdf</cite> file and an <cite>mp4</cite> movie:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">generations</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">automata</span> <span class="o">=</span> <span class="n">OneDCellularAutomata</span><span class="p">(</span>
  <span class="n">generations</span><span class="o">=</span><span class="n">generations</span><span class="p">,</span>
  <span class="n">machine_cls</span><span class="o">=</span><span class="n">Rule30</span><span class="p">,</span>
  <span class="n">wall_cls</span><span class="o">=</span><span class="n">WallLeftWhiteRightWhite</span><span class="p">)</span>

<span class="n">ecosystem</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">automata</span><span class="p">)</span>
<span class="n">ecosystem</span><span class="o">.</span><span class="n">run_animation</span><span class="p">(</span><span class="n">generations</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># 100 ms</span>
<span class="n">eco</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;rule_30_white_walls_200_generations.mp4&#39;</span><span class="p">)</span>
<span class="n">eco</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;rule_30_white_walls_200_generations.pdf&#39;</span><span class="p">)</span>
<span class="n">eco</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;rule_30_white_walls_200_generations.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is the movie:</p>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/lB3oZ5DkPks" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center><p>Here is the <cite>pgn</cite> diagram, click on it to see the <cite>pdf</cite> version of the same picture:</p>
<a class="reference external image-reference" href="_static/rule_30_white_walls_200_generations.pdf"><img alt="_images/rule_30_white_walls_200_generations.png" class="align-center" src="_images/rule_30_white_walls_200_generations.png" /></a>
<p>Let’s try it with black walls</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">generations</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">automata</span> <span class="o">=</span> <span class="n">OneDCellularAutomata</span><span class="p">(</span>
  <span class="n">generations</span><span class="o">=</span><span class="n">generations</span><span class="p">,</span>
  <span class="n">machine_cls</span><span class="o">=</span><span class="n">Rule30</span><span class="p">,</span>
  <span class="n">wall_cls</span><span class="o">=</span><span class="n">WallLeftBlackRightBlack</span><span class="p">)</span>

<span class="n">ecosystem</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">automata</span><span class="p">)</span>
<span class="n">ecosystem</span><span class="o">.</span><span class="n">run_animation</span><span class="p">(</span><span class="n">generations</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>  <span class="c1"># 50 ms</span>
<span class="n">eco</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;rule_30_black_walls_200_generations.mp4&#39;</span><span class="p">)</span>
<span class="n">eco</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;rule_30_black_walls_200_generations.pdf&#39;</span><span class="p">)</span>
<span class="n">eco</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;rule_30_black_walls_200_generations.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is a <a class="reference external" href="https://www.youtube.com/watch?v=qSsddlg9o2M&amp;feature=youtu.be">link</a> to the resulting video, and below you can see what happens when we run 200 generations of rule 30 with black walls.</p>
<a class="reference external image-reference" href="_static/rule_30_black_walls_200_generations.pdf"><img alt="_images/rule_30_black_walls_200_generations.png" class="align-center" src="_images/rule_30_black_walls_200_generations.png" /></a>
<p><a class="reference external" href="https://youtu.be/r24NV8vQPKc">Running it again for 500 generations</a> and with white walls results in this:</p>
<a class="reference external image-reference" href="_static/rule_30_white_walls_500_generations.pdf"><img alt="_images/rule_30_white_walls_500_generations.png" class="align-center" src="_images/rule_30_white_walls_500_generations.png" /></a>
<p>On this diagram we can see order imposing itself from the left white wall, and a <a class="reference external" href="https://blog.stephenwolfram.com/data/uploads/2017/05/5.png">kind of repeating pattern on the left side of the triangle</a> which emerges from our initial conditions.  The center and right part of the results seem to be full of disorder.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>On limitations:</p>
<p>The pdf resulting from the 500 generation run of our automata is over 5 MB;
this is a lot of data to add to your computer if you want to clone the miros
library, so I will refrain from going bigger.</p>
<p class="last">It took a long time to render the 500 generation automata.  I don’t know
where the computational bottle-neck is coming from; if it were important to
me I could profile the different parts of the code until I found my issue,
but the issue could be Python itself.  Mathematica has no such obvious
limitation. If you want to do a deep dive into this subject and don’t have
the resources to buy a Mathematica licence, you can buy a Raspberry Pi with
the NOOBs OS, then VNC onto the device from your desktop.  Wolfram Alpha is
being given away on this platform.</p>
</div>
</div>
<div class="section" id="the-nothing-n-phenomenon">
<span id="cellular-automata-the-nothing"></span><h2>The Nothing (n-phenomenon)<a class="headerlink" href="#the-nothing-n-phenomenon" title="Permalink to this headline">¶</a></h2>
<p>The white and black walls force order into the automata; causing a kind of
pattern crystallization to propagate across our results.  We lose the incredible
complexity of rule 30, to this ordering pattern, which I think of as the
<a class="reference external" href="https://www.youtube.com/watch?v=_-5QTdC7hOo">nothing</a>. Order imposes itself
like a prion does in the brain of someone with Alzheimer’s.  We have seen that
this effect takes place with both white and black walls, the key is that there
is an inflexible minority on the walls, imposing itself on a flexible majority.
(Nassim Nicholas Taleb calls this kind of thing <a class="reference external" href="https://medium.com/incerto/the-most-intolerant-wins-the-dictatorship-of-the-small-minority-3f1f83ce4e15">a normalization</a>.)</p>
<p>I will call this destructive ordering, the n-phenomenon.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Our universe seems to have set rules (the laws of physics) but it will not run
into this n-phenomenon, repetition issue; because it doesn’t seem to be
confined within walls or have limited memory: the universe is expanding at an
accelerating rate.</p>
<p class="last">Maybe it would have been wiped out by an n-phenomenon if it weren’t expanding.</p>
</div>
<p>Let’s study it in a bit more detail.  I will shrink the width of our graphing
paper to 30 cells and watch the n-phenomenon completely destroy rule 30’s beautiful
complexity over 100 generations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">generations</span> <span class="o">=</span> <span class="mi">100</span>

 <span class="n">automata</span> <span class="o">=</span> <span class="n">OneDCellularAutomata</span><span class="p">(</span>
   <span class="n">generations</span><span class="o">=</span><span class="n">generations</span><span class="p">,</span>
   <span class="n">machine_cls</span><span class="o">=</span><span class="n">Rule30</span><span class="p">,</span>
   <span class="n">wall_cls</span><span class="o">=</span><span class="n">WallLeftWhiteRightWhite</span><span class="p">,</span>
<span class="hll">   <span class="n">cells_per_generation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</span>
 <span class="n">ecosystem</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">automata</span><span class="p">)</span>
 <span class="n">ecosystem</span><span class="o">.</span><span class="n">run_animation</span><span class="p">(</span><span class="n">generations</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>  <span class="c1"># 500 ms</span>
 <span class="n">eco</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;rule_30_white_walls_100_generations_width_30.mp4&#39;</span><span class="p">)</span>
</pre></div>
</div>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/oadp1sh69jE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center><p>It seems that the n-phenomenon has a pattern velocity; resulting in an angle.
My protractor tells me that the ordered crystallization, caused by the white
minority at the wall, spreads downward at an angle of about 20 degrees.</p>
<p>If we reduce the width of the graphing paper, this pattern seems to
advance quicker into the chaos:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">generations</span> <span class="o">=</span> <span class="mi">100</span>

 <span class="n">automata</span> <span class="o">=</span> <span class="n">OneDCellularAutomata</span><span class="p">(</span>
   <span class="n">generations</span><span class="o">=</span><span class="n">generations</span><span class="p">,</span>
   <span class="n">machine_cls</span><span class="o">=</span><span class="n">Rule30</span><span class="p">,</span>
   <span class="n">wall_cls</span><span class="o">=</span><span class="n">WallLeftWhiteRightWhite</span><span class="p">,</span>
<span class="hll">   <span class="n">cells_per_generation</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span>
 <span class="n">ecosystem</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">automata</span><span class="p">)</span>
 <span class="n">ecosystem</span><span class="o">.</span><span class="n">run_animation</span><span class="p">(</span><span class="n">generations</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>  <span class="c1"># 500 ms</span>
 <span class="n">eco</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;rule_30_white_walls_100_generations_width_30.mp4&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the 30 cell width result to the 15 cell width result:</p>
<center>
<div style="float:left;">
<iframe width="330" height="315" src="https://www.youtube.com/embed/oadp1sh69jE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

<div style="float:left;">
<iframe width="330" height="315" src="https://www.youtube.com/embed/IVLnbYamjXk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<div style="clear:both;"></div>
</center><p>Let’s try going thinner, here is a 15 cell width result beside a 10 cell width result:</p>
 <center>

 <div style="float:left;">
 <iframe width="330" height="315" src="https://www.youtube.com/embed/IVLnbYamjXk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
 </div>
 <div style="float:left;">
<iframe width="330" height="315" src="https://www.youtube.com/embed/whmwZEoYDz8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
 </div>
 <div style="clear:both;"></div>
 </center><p>So the angle of the n-phenomenon does not necessarily shrink with a reduction in
the graphing paper’s width.</p>
<p>Let’s write some code that can calculate the angle of the n-phenomenon.</p>
<p>We will set the walls to be white and the initial condition is a single black
rule 30 machine, sandwiched between other rule 30 machines started in the white
state:</p>
<a class="reference external image-reference" href="_static/rule_30_twodcellularautomata_with_angle.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_twodcellularautomata_with_angle.svg" src="_images/rule_30_twodcellularautomata_with_angle.svg" /></div>
</a>
<p>The blue object in the diagram represents the disordered part of a rule 30
simulation contained by white walls.  The cyan circle is the angle, in degrees, we are
searching for.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">OneDCellularAutomataWithAngleDiscovery</span><span class="p">(</span><span class="n">OneDCellularAutomata</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
      <span class="n">generations</span><span class="p">,</span>
      <span class="n">cells_per_generation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
      <span class="n">initial_condition_index</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
      <span class="n">machine_cls</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
      <span class="n">wall_cls</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
      <span class="n">generations</span><span class="p">,</span>
      <span class="n">cells_per_generation</span><span class="p">,</span>
      <span class="n">initial_condition_index</span><span class="p">,</span>
      <span class="n">machine_cls</span><span class="p">,</span>
      <span class="n">wall_cls</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">black_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Black</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">white_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">White</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
       <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">white_mask</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">black_mask</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_angle</span> <span class="o">=</span> <span class="mi">90</span>

  <span class="k">def</span> <span class="nf">build_next_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mask</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">White</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">n_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mask</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">black_mask</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">n_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mask</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">white_mask</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">update_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

    <span class="n">previous_generation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generation</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">row_to_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span><span class="p">[</span><span class="n">previous_generation</span><span class="p">]</span>
    <span class="n">sub_row_to_check</span> <span class="o">=</span> <span class="n">row_to_check</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mask</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_mask</span><span class="p">,</span> <span class="n">sub_row_to_check</span><span class="p">):</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">nothing_at_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generations</span><span class="o">-</span><span class="n">previous_generation</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">adjacent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nothing_at_row</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells_per_generation</span> <span class="o">/</span> <span class="mf">2.0</span>
      <span class="n">opposite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells_per_generation</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">n_angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">opposite</span><span class="o">/</span><span class="n">adjacent</span><span class="p">))</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">build_next_mask</span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">next_generation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">next_generation</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_angle</span><span class="p">()</span>
</pre></div>
</div>
<p>With this code we can plot how the angle of the n-phenomenon changes as a
function of the graphing paper width:</p>
<a class="reference external image-reference" href="_static/cells_per_generation_vrs_angle_of_n_phenomenon.pdf"><div align="center" class="align-center"><img alt="_images/cells_per_generation_vrs_angle_of_n_phenomenon.svg" src="_images/cells_per_generation_vrs_angle_of_n_phenomenon.svg" /></div>
</a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The angle is still an approximation, since as you will see shortly, the
n-phenomenon is not a straight line.</p>
</div>
<p>Here is a video of 196 different renderings of rule thirty within white walls.
The video starts with 2 rule 30 machines squished between two white walls.
For each frame advance of the video, a cell is added to the width of the
graphing paper and the automata is restarted an run with a black machine
at the top and middle of the simulation.</p>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8aHWeo_dgs0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center><p>The top part of the video remains constant as the width of the graphing paper
expands, which makes sense, since that part of the diagram experiences the same
set of initial conditions.  What is surprising is how avalanches perpetuate
through the diagram as the width of the graphing paper increases.  The left side
will cause an avalanche for two frames, then the right side will cause an
avalanche for two frames, then the left side again and so on and so forth.</p>
<p>You can see when the patterns are going to shift by watching for the “left white
_|” and the “black right L”.  If either of these mini-patterns appear, it will
tell you that the avalanche on their side of the diagram is over, and to move
your eyes to the other side of the page for the next frame.</p>
<p>As tempting as it is to think that this 2 beat oscillation is a feature of the
automata, it probably isn’t.  The 2 beat oscillation is the result of the
divide-by-2-and-round-the-result mixed with the
expansion-of-the-size-of-the-page.  Essentially we are changing the initial
conditions on one side of the page for 2 beats, then the other side for two
beats.  Because rule 30 creates a chaotic system that is highly sensitive to its
initial conditions we have avalanches of change in response to a new
partial-starting-state. The initial conditions remain the same for the top part
of the diagram, but are expressed when the rule 30 body hits the new wall
condition.</p>
<p>The video makes me think about time traveling stories.  If we imagine the new
starting condition as the location of a time traveler arriving in the past from
the future (to change one thing and then leave), we can see how he effects
history as the change-avalanche on his side of the video frame.  The entire past
isn’t changed, just the side that was within the causal cone of his avalanche.</p>
<p>The rule 30 states only one square can be effected each generation; so the
maximum theoretical propagation of a historical distortion is 45 degrees.  In
our reality we also have such a causal limitation, it is the speed of light, c.</p>
<p>Here is another video of 196 different renderings with a white left wall and
black right wall:</p>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DtDaKKeOsOg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center><p>Black left, white right wall:</p>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/gO-Y6UfMj70" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center><p>Left and right walls set to black:</p>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/z1R8-gZd5wQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</center></div>
</div>
<div class="section" id="random-number-generation">
<h1>Random Number Generation<a class="headerlink" href="#random-number-generation" title="Permalink to this headline">¶</a></h1>
<p>Let’s try and build a random number generator using a simple Python program.</p>
<p>First we should discuss our constraints.  Rule 30 provides an interesting
chaotic phenomenon, we would like to use this rule versus another rule, or we
may accidentally lose our ability to generate chaos.  If we make our graphing
paper very wide, then we need more computer memory and more computing resources
to construct the next generation of automata.  If we use walls, then we have
order imposing itself back into the body of the chaos, as the n-phenomenon, over
only a few generations.  Even if we can perfectly manage this n-phenomenon,
there are only so many permutations that can be held within the bounds of our
rectangle, and if we repeat a pattern we are not generating a random number, but
rather a long periodic number; a pseudo-random number.</p>
<p>So there seems to be a theoretical upper bound to what we can generate using
limited memory given that the rule doesn’t change and the state of the program
is held within a bounded rectangle. My first guess at what our upper bound is:
<code class="docutils literal notranslate"><span class="pre">2**n</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of states within the rectangle, and the <code class="docutils literal notranslate"><span class="pre">2</span></code>
is selected because we are only tracking two colors, black and white.</p>
<p>First things first, let’s deal with the n-phenomenon coming from the walls.  We
have control of the walls, and we have a chaos generator, so let’s feed the
chaos back into the walls.</p>
<a class="reference external image-reference" href="_static/rule_30_chaos_to_walls_1.pdf"><div align="center" class="align-center"><img alt="_images/rule_30_chaos_to_walls_1.svg" src="_images/rule_30_chaos_to_walls_1.svg" /></div>
</a>
<p>We can write the colors of our center column into a deque, and use the top two
colors of this deque to set the color of the walls.  Let’s call this deque the
<code class="docutils literal notranslate"><span class="pre">core_colors</span></code>.  To begin with we set all of the <code class="docutils literal notranslate"><span class="pre">core_colors</span></code> to white, so
that the walls will remain white for the first <code class="docutils literal notranslate"><span class="pre">len(core_colors)</span></code> generations.
For every <code class="docutils literal notranslate"><span class="pre">Next</span></code> event, the <code class="docutils literal notranslate"><span class="pre">core_colors</span></code> deque is pushed one spot downward
into the center of our automata, where it is painted with the color of the core
at that spot.</p>
<p>We will use the last two elements of our <code class="docutils literal notranslate"><span class="pre">core_colors</span></code> to determine the color
of our walls.  These last two spots will act as a 2 digit binary number, holding
the values of <code class="docutils literal notranslate"><span class="pre">WallLeftWhiteRightWhite</span></code>, <code class="docutils literal notranslate"><span class="pre">WallLeftWhiteRightBlack</span></code>,
<code class="docutils literal notranslate"><span class="pre">WallLeftBlackRightWhite</span></code> and <code class="docutils literal notranslate"><span class="pre">WallLeftBlackRightBlack</span></code>.  How this rule is
applied isn’t that important, it just has to consistently map the center’s chaos
onto the walls.</p>
<p>So, how long do we make this <code class="docutils literal notranslate"><span class="pre">core_colors</span></code> deque?  My intuition is to feed it
as much chaos as rule 30 can generate, then feed this back into the automata
before the n-phenomenon destroys the disorder.</p>
<p>Every intuition I have had so far about rule 30 has been wrong, so I’ll probably
be wrong about this too.  I need some way to to disprove my prediction, and I
can’t eye-ball repeating patterns reliably beyond 30 generations, so I will
adjust the code to inform on it’s own periodicity using an autocorrelation.</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="17%" />
<col width="37%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Cell Width and angle</th>
<th class="head">Queue Depth</th>
<th class="head">Unique Pattern Duration</th>
<th class="head">Repeats?</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="12">10 (35.7 degrees)</td>
<td rowspan="12"><p class="first">2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10*</p>
<p>11</p>
<p>12</p>
<p class="last">13</p>
</td>
<td rowspan="12"><p class="first">37</p>
<p>51</p>
<p>14</p>
<p>16</p>
<p>35</p>
<p>30</p>
<p>65</p>
<p>24</p>
<p>52</p>
<p>110</p>
<p>30</p>
<p class="last">32</p>
</td>
<td rowspan="12">True</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="17">11 (44.4 degrees)</td>
<td rowspan="17"><p class="first">2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13*</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p class="last">18</p>
</td>
<td rowspan="17"><p class="first">53</p>
<p>5</p>
<p>24</p>
<p>57</p>
<p>28</p>
<p>30</p>
<p>32</p>
<p>27</p>
<p>36</p>
<p>42</p>
<p>80</p>
<p>42</p>
<p>84</p>
<p>46</p>
<p>48</p>
<p>50</p>
<p class="last">52</p>
</td>
<td rowspan="17">True</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="17">12 (36.0 degrees)</td>
<td rowspan="17"><p class="first">2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12*</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p class="last">18</p>
</td>
<td rowspan="17"><p class="first">16</p>
<p>35</p>
<p>24</p>
<p>26</p>
<p>39</p>
<p>58</p>
<p>19</p>
<p>14</p>
<p>46</p>
<p>36</p>
<p>53</p>
<p>32</p>
<p>42</p>
<p>276</p>
<p>46</p>
<p>13</p>
<p class="last">25</p>
</td>
<td rowspan="17">True</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="23">13 (36.0 degrees)</td>
<td rowspan="23"><p class="first">2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12*</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p class="last">24</p>
</td>
<td rowspan="23"><p class="first">16</p>
<p>5</p>
<p>9</p>
<p>12</p>
<p>46</p>
<p>34</p>
<p>15</p>
<p>65</p>
<p>139</p>
<p>24</p>
<p>44</p>
<p>121</p>
<p>35</p>
<p>157</p>
<p>318</p>
<p>465</p>
<p>278</p>
<p>76</p>
<p>225</p>
<p>197</p>
<p>384</p>
<p>30</p>
<p class="last">162</p>
</td>
<td rowspan="23">True</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="28">14 (30.2 degrees)</td>
<td rowspan="28"><p class="first">2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13*</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p>25</p>
<p>26</p>
<p>27</p>
<p>28</p>
<p class="last">29</p>
</td>
<td rowspan="28"><p class="first">42</p>
<p>43</p>
<p>13</p>
<p>20</p>
<p>26</p>
<p>9</p>
<p>32</p>
<p>176</p>
<p>271</p>
<p>279</p>
<p>20</p>
<p>236</p>
<p>395</p>
<p>66</p>
<p>208</p>
<p>13</p>
<p>338</p>
<p>195</p>
<p>228</p>
<p>98</p>
<p>210</p>
<p>255</p>
<p>1450</p>
<p>32</p>
<p>1223</p>
<p>287</p>
<p>1012</p>
<p class="last">610</p>
</td>
<td rowspan="28">True</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="22">15 (39.2 degrees)</td>
<td rowspan="22"><p class="first">4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16*</p>
<p>17</p>
<p>18</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p class="last">25</p>
</td>
<td rowspan="22"><p class="first">44</p>
<p>160</p>
<p>134</p>
<p>60</p>
<p>58</p>
<p>48</p>
<p>52</p>
<p>200</p>
<p>160</p>
<p>74</p>
<p>429</p>
<p>541</p>
<p>1022</p>
<p>73</p>
<p>17</p>
<p>271</p>
<p>232</p>
<p>534</p>
<p>564</p>
<p>1210</p>
<p>258</p>
<p class="last">630</p>
</td>
<td rowspan="22">True</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="25">16 (34.0 degrees)</td>
<td rowspan="25"><p class="first">2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16*</p>
<p>17</p>
<p>18</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p>25</p>
<p class="last">26</p>
</td>
<td rowspan="25"><p class="first">111</p>
<p>18</p>
<p>42</p>
<p>123</p>
<p>74</p>
<p>35</p>
<p>288</p>
<p>310</p>
<p>42</p>
<p>582</p>
<p>46</p>
<p>40</p>
<p>86</p>
<p>252</p>
<p>378</p>
<p>180</p>
<p>900</p>
<p>288</p>
<p>541</p>
<p>1746</p>
<p>1017</p>
<p>117</p>
<p>1162</p>
<p>551</p>
<p class="last">1182</p>
</td>
<td rowspan="25">True</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="21">17 (35.3 degrees)</td>
<td rowspan="21"><p class="first">5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18*</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p class="last">25</p>
</td>
<td rowspan="21"><p class="first">36</p>
<p>47</p>
<p>270</p>
<p>164</p>
<p>92</p>
<p>42</p>
<p>179</p>
<p>433</p>
<p>448</p>
<p>238</p>
<p>120</p>
<p>60</p>
<p>1054</p>
<p>441</p>
<p>1149</p>
<p>390</p>
<p>1582</p>
<p>600</p>
<p>3305</p>
<p>214</p>
<p class="last">2810</p>
</td>
<td rowspan="21">True</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="27">18 (27.7 degrees)</td>
<td rowspan="27"><p class="first">4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17*</p>
<p>18</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p>25</p>
<p>26</p>
<p>27</p>
<p>28</p>
<p>29</p>
<p class="last">30</p>
</td>
<td rowspan="27"><p class="first">97</p>
<p>90</p>
<p>158</p>
<p>82</p>
<p>192</p>
<p>319</p>
<p>70</p>
<p>101</p>
<p>200</p>
<p>586</p>
<p>597</p>
<p>24</p>
<p>430</p>
<p>860</p>
<p>459</p>
<p>605</p>
<p>532</p>
<p>609</p>
<p>2356</p>
<p>1730</p>
<p>908</p>
<p>734</p>
<p>1513</p>
<p>1653</p>
<p>165</p>
<p>954</p>
<p class="last">682</p>
</td>
<td rowspan="27"><p class="first">True</p>
<p>False</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p class="last">True</p>
</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="25">19 (27.5 degrees)</td>
<td rowspan="25"><p class="first">4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10**</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18*</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p>25</p>
<p>26</p>
<p>27</p>
<p class="last">28</p>
</td>
<td rowspan="25"><p class="first">11</p>
<p>75</p>
<p>91</p>
<p>99</p>
<p>43</p>
<p>33</p>
<p>33</p>
<p>144</p>
<p>134</p>
<p>70</p>
<p>252</p>
<p>250</p>
<p>155</p>
<p>677</p>
<p>1943</p>
<p>1299</p>
<p>130</p>
<p>2689</p>
<p>5168</p>
<p>1602</p>
<p>922</p>
<p>2080</p>
<p>2895</p>
<p>5341</p>
<p class="last">3520</p>
</td>
<td rowspan="25">True</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="27">20 (27.5 degrees)</td>
<td rowspan="27"><p class="first">4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18*</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p>25</p>
<p>26</p>
<p>27</p>
<p>28</p>
<p>29</p>
<p class="last">30</p>
</td>
<td rowspan="27"><p class="first">11</p>
<p>75</p>
<p>91</p>
<p>99</p>
<p>43</p>
<p>279</p>
<p>213</p>
<p>202</p>
<p>327</p>
<p>792</p>
<p>490</p>
<p>1436</p>
<p>1349</p>
<p>556</p>
<p>1171</p>
<p>172</p>
<p>333</p>
<p>2912</p>
<p>2054</p>
<p>5769</p>
<p>1546</p>
<p>579</p>
<p>400</p>
<p>4535</p>
<p>9075</p>
<p>9709</p>
<p class="last">1697</p>
</td>
<td rowspan="27">True</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="29">21 (27.5 degrees)</td>
<td rowspan="29"><p class="first">2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18</p>
<p>19*</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p>25</p>
<p>26</p>
<p>27</p>
<p>28</p>
<p>29</p>
<p class="last">30</p>
</td>
<td rowspan="29"><p class="first">615</p>
<p>333</p>
<p>2912</p>
<p>422</p>
<p>534</p>
<p>113</p>
<p>429</p>
<p>82</p>
<p>79</p>
<p>551</p>
<p>862</p>
<p>2159</p>
<p>91</p>
<p>526</p>
<p>1327</p>
<p>837</p>
<p>1429</p>
<p>1173</p>
<p>220</p>
<p>3706</p>
<p>300</p>
<p>27</p>
<p>3090</p>
<p>6036</p>
<p>44</p>
<p>3416</p>
<p>9032</p>
<p>2067</p>
<p class="last">9151</p>
</td>
<td rowspan="29">True</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="30">22 (24.0 degrees)</td>
<td rowspan="30"><p class="first">2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18</p>
<p>19</p>
<p>20</p>
<p>21</p>
<p>22</p>
<p>23</p>
<p>24</p>
<p>25</p>
<p>26</p>
<p>27</p>
<p>28</p>
<p>29</p>
<p>30</p>
<p class="last">31</p>
</td>
<td rowspan="30"><p class="first">113</p>
<p>58</p>
<p>350</p>
<p>120</p>
<p>197</p>
<p>135</p>
<p>169</p>
<p>47</p>
<p>123</p>
<p>330</p>
<p>219</p>
<p>981</p>
<p>569</p>
<p>763</p>
<p>398</p>
<p>694</p>
<p>584</p>
<p>373</p>
<p>357</p>
<p>759</p>
<p>433</p>
<p>266</p>
<p>204</p>
<p>4395</p>
<p>527</p>
<p>1138</p>
<p>3383</p>
<p>3562</p>
<p>148</p>
<p class="last">4611</p>
</td>
<td rowspan="30"><p class="first">True</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>False</p>
<p>False</p>
<p>False</p>
<p>True</p>
<p>False</p>
<p>False</p>
<p>True</p>
<p>False</p>
<p>False</p>
<p>False</p>
<p>False</p>
<p>True</p>
<p>True</p>
<p>True</p>
<p>False</p>
<p>False</p>
<p>False</p>
<p>False</p>
<p>True</p>
<p>False</p>
<p>True</p>
<p>True</p>
<p>False</p>
<p>False</p>
<p>False</p>
<p class="last">False</p>
</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
</tbody>
</table>
<p>** means, that there is a kind of n-phenomenon pattern that emerges after some
time, but before this a nice, richly chaotic pattern existed.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Stephen Wolfram (2002). <a class="reference external" href="https://www.wolframscience.com/">A New Kind of Science.</a> (p27)</td></tr>
</tbody>
</table>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="index.html">
  <img class="logo_a" src="_static/miros_a.svg" width="250" alt="Logo" >
</a></p>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Cellular Automata</a><ul>
<li><a class="reference internal" href="#high-level-sketches">High Level Sketches</a><ul>
<li><a class="reference internal" href="#automata-running-inside-of-walls">Automata Running Inside of Walls</a></li>
<li><a class="reference internal" href="#high-level-design-diagram">High Level Design Diagram</a></li>
<li><a class="reference internal" href="#statemachines-needed-to-build-rule-30-in-walls">Statemachines Needed to Build Rule 30 in Walls</a></li>
</ul>
</li>
<li><a class="reference internal" href="#design-and-code">Design and Code</a><ul>
<li><a class="reference internal" href="#canvas-class">Canvas Class</a></li>
<li><a class="reference internal" href="#the-onedcellularautomata-class">The OneDCellularAutomata Class</a></li>
<li><a class="reference internal" href="#rule30-and-the-wall-classes">Rule30 and the Wall Classes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-and-visualizing-the-cellular-automata">Running and Visualizing the Cellular Automata</a></li>
<li><a class="reference internal" href="#the-nothing-n-phenomenon">The Nothing (n-phenomenon)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#random-number-generation">Random Number Generation</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="examples.html">Examples</a><ul>
      <li>Previous: <a href="comprehensive.html" title="previous chapter">Comprehensive</a></li>
      <li>Next: <a href="singlechartexample.html" title="next chapter">Active Object Example</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/cellular_automata.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Scott Volk.
      
      |
      <a href="_sources/cellular_automata.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>