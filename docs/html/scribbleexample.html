







<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Hacking to Learn | miros</title>
    <link rel="shortcut icon" href="_static/favicon.ico">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css">
    <link rel="stylesheet" href="_static/theme.css" type="text/css">
    
      
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      
    
      
    <link rel="stylesheet" type="text/css" href="_static/theme.css" />
      
    
      
    <link rel="stylesheet" type="text/css" href="_static/css/miros_docs.css" />
      
    
    

    
    <script type="text/javascript" src="_static/theme.js" defer></script>
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    
    <script src="_static/jquery.js"></script>
    
    <script src="_static/underscore.js"></script>
    
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    
    <script src="_static/doctools.js"></script>
    
    

    
      
      
    <link rel="index" title="Index" href="genindex.html">
      
      
    <link rel="search" title="Search" href="search.html">
      
      
      
    <link rel="next" title="Interacting Statecharts (Same Machine)" href="interactingcharts.html">
      
      
    <link rel="prev" title="Thread Safe Attributes" href="thread_safe_attributes.html">
      
    

    

    

    
  </head>

  <body>
    <header class="main-header">
      <div class="navbar">
        <div id="js-sidebar-mask" class="sidebar-mask"></div>
        <div id="js-sidebar-menu-button" class="sidebar-menu-button">
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg>
        </div>
        <a href="index.html" class="site-link">
          
          miros
          
        </a>
        <div class="navbar-links">
          <a href="installation.html" class="navbar-link">Docs</a>
          
          <a href="https://github.com/aleph2c/miros" class="navbar-link">GitHub</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg>
          
        </div>
      </div>
    </header>

    <main class="main-wrapper">
      
      <div id="js-main-sidebar" class="main-sidebar">
        
        <div class="sidebar-content sidebar-content--divider sidebar-navbar-links">
          <a href="https://github.com/aleph2c/miros" class="sidebar-navbar-link">GitHub</a>
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg>
        </div>
        
        
        <div class="sidebar-content sidebar-logo">
    <a href="index.html">
      <img class="logo" src="_static/miros_logo.svg" alt="miros" >
    </a>
</div>
        
        

<h2 class="sidebar-heading">Contents</h2>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="zero_to_one.html">Tutorial: Zero to One</a></li>
<li class="toctree-l1"><a class="reference internal" href="reading_diagrams.html">Diagrams</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="comprehensive.html">Comprehensive</a></li>
<li class="toctree-l2"><a class="reference internal" href="comprehensive.html#comprehensive-with-instrumentation">Comprehensive with Instrumentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="thread_safe_attributes.html">Thread Safe Attributes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Hacking to Learn</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-picture-and-a-question">A Picture and a Question</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-partial-answer">A Partial Answer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-better-answer">A Better Answer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#our-first-working-hypothesis">Our First Working Hypothesis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-make-a-picture">Code, Make a Picture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-required-imports">Code, Required Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-frame-in-the-states">Code, Frame in the States</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-add-common-internal-state-code">Code, Add Common Internal State Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-add-hiearchy">Code, Add Hiearchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-add-the-t-and-init-events">Code, Add the T and Init events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-see-if-anything-runs">Code, See if anything Runs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-add-the-guard-and-t-function">Code, Add the guard and t function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-add-the-other-functions">Code, Add the other functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#challenging-our-hypothesis">Challenging Our Hypothesis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#learning-for-my-mistake">Learning for my Mistake</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="interactingcharts.html">Interacting Statecharts (Same Machine)</a></li>
<li class="toctree-l2"><a class="reference internal" href="towardsthefactoryexample.html">Using and Unwinding a Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="othogonalregions.html">Orthogonal Regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="batterychargingexample.html">Distributed Battery Charging</a></li>
<li class="toctree-l2"><a class="reference internal" href="cellular_automata.html">Cellular Automata</a></li>
<li class="toctree-l2"><a class="reference internal" href="i_mongol_example.html">Mongol Horse Archer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="reflection.html">Reflection</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns.html">Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
</ul>

        
        
<h2 class="sidebar-heading">Useful Links</h2>

<ul>
  <li><a href="https://github.com/aleph2c/py-activeobject">miros on github</a></li>
  <li><a href="https://github.com/aleph2c/sequence">sequence on github</a></li>
  <li><a href="https://aleph2c.github.io/miros-rabbitmq/html/index.html">miros-rabbitmq plugin</a></li>
  <li><a href="http://www.umlet.com">UMLet Download</a></li>
  <li><a href="http://www.inf.ed.ac.uk/teaching/courses/seoc/2005_2006/resources/statecharts.pdf">formalism explained</a></li>
</ul>


<h2 class="sidebar-heading">For Embedded</h2>

<ul>
  <li><a href="https://state-machine.com/">Quantum Leaps for Embedded</a></li>
  <li><a href="https://github.com/QuantumLeaps/">Quantum Leaps On Github</a></li>
</ul>


<h2 class="sidebar-heading">Statechart Videos</h2>

<ul>
  <li><a href="https://www.mathworks.com/videos/understanding-state-machines-what-are-they-1-of-4-90488.html">Part 1 (What)</a></li>
  <li><a href="https://www.mathworks.com/videos/understanding-state-machines-why-use-them-2-of-4-90489.html">Part 2 (Why)</a></li>
  <li><a href="https://www.mathworks.com/videos/understanding-state-machines-what-are-they-1-of-4-90488.html">Part 3 (Mealy/Moore)</a></li>
  <li><a href="https://www.mathworks.com/videos/understanding-state-machines-harel-state-machines-4-of-4-90491.html">Part 4 (Harel Statecharts)</a></li>
  <li><a href="https://barrgroup.com/Embedded-Systems/How-To/Introduction-Hierarchical-State-Machines">Introduction to HSMs</a></li>
</ul>
        
        

<div id="searchbox" style="display: none" role="search">
  <h2 id="searchlabel" class="sidebar-heading">Quick search</h2>
  <div class="searchformwrapper sidebar-content">
    <form class="search" action="search.html" method="get">
      <input class="sidebar-search sidebar-search--input" type="text" name="q" aria-labelledby="searchlabel"><input class="sidebar-search sidebar-search--btn" type="submit" value="Go">
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>

        
      </div>
      

      
      <div class="main-content main-content--sidebar">
      
        
          
  <blockquote class="epigraph">
<div><p>What I learned on my own I still remember</p>
<p class="attribution">—Nassim Nicholas Taleb</p>
</div></blockquote>
<section id="hacking-to-learn">
<span id="scribbleexample-hacking-to-learn-the-deeper-dynamics"></span><h1>Hacking to Learn<a class="headerlink" href="#hacking-to-learn" title="Permalink to this heading">#</a></h1>
<p id="scribbleexample-first-pass">In this example I ask a small question about a statechart.  Then we will:</p>
<ol class="arabic simple">
<li><p>try to answer the question</p></li>
<li><p>build the chart in working code</p></li>
<li><p>test out our answer</p></li>
<li><p>learn something</p></li>
</ol>
<section id="a-picture-and-a-question">
<h2>A Picture and a Question<a class="headerlink" href="#a-picture-and-a-question" title="Permalink to this heading">#</a></h2>
<img alt="_images/scribble.svg" class="noscale-center" src="_images/scribble.svg" /><p>Suppose we started the above chart in <code class="docutils literal notranslate"><span class="pre">s11</span></code>, then we send a <code class="docutils literal notranslate"><span class="pre">T</span></code> event to it,
when would each of the functions, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, and <code class="docutils literal notranslate"><span class="pre">t</span></code> happen?</p>
<p>If you are unfamiliar with UML, this part of the diagram:</p>
<img alt="_images/guard2.svg" class="noscale-left" src="_images/guard2.svg" /><p>…contains a <strong>guard</strong>.  Specifically, the code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">g</span><span class="p">()]</span>
</pre></div>
</div>
<p>…on the arrow is the <strong>guard</strong>.</p>
<p>It is shorthand for: <cite>if the logic between the square brackets is True then let
the event on the arrow pass through</cite>.  The code that is after the guard on the
diagram, <code class="docutils literal notranslate"><span class="pre">t()</span></code>, runs if the guard doesn’t block it.  Now that we know how a
guard works, we can infer that:</p>
<a class="reference external image-reference" href="_static/guard2.pdf"><img alt="_images/guard2.svg" class="noscale-left" src="_images/guard2.svg" /></a>
<p>…means:</p>
<ol class="arabic simple">
<li><p>When I see a <cite>T</cite> event, ask for permission from the guard to see if it can pass.</p></li>
<li><p>The <cite>g</cite> function is the guard</p></li>
<li><p>If <cite>g</cite> returns True, <cite>T</cite> can pass; it can run the <cite>t</cite> function then make the transition to state <cite>s2</cite> <a class="footnote-reference brackets" href="#f1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p></li>
<li><p>If <cite>g</cite> returns False the <cite>T</cite> event is ignored by the chart.</p></li>
</ol>
</section>
<section id="a-partial-answer">
<h2>A Partial Answer<a class="headerlink" href="#a-partial-answer" title="Permalink to this heading">#</a></h2>
<p>Now that we understand that, let’s re-ask the question:</p>
<p>“Suppose we started the above chart in <code class="docutils literal notranslate"><span class="pre">s11</span></code>, then we send a <code class="docutils literal notranslate"><span class="pre">T</span></code> event to it,
when would each of the functions, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, and <code class="docutils literal notranslate"><span class="pre">t</span></code> happen?”</p>
<a class="reference external image-reference" href="_static/scribble.pdf"><img alt="_images/scribble.svg" class="noscale-center" src="_images/scribble.svg" /></a>
<p>Well, if we start in <code class="docutils literal notranslate"><span class="pre">s11</span></code>, then we receive a <code class="docutils literal notranslate"><span class="pre">T</span></code>, <code class="docutils literal notranslate"><span class="pre">s11</span></code> wouldn’t know
what to do with <code class="docutils literal notranslate"><span class="pre">T</span></code>, so it would pass it out to <code class="docutils literal notranslate"><span class="pre">s1</span></code>.  <code class="docutils literal notranslate"><span class="pre">s1</span></code> <em>does know</em>
what to do with <code class="docutils literal notranslate"><span class="pre">T</span></code>, it would try to pass it to <code class="docutils literal notranslate"><span class="pre">s2</span></code>.</p>
<p>Ok, now how do we get from <code class="docutils literal notranslate"><span class="pre">s11</span></code> to <code class="docutils literal notranslate"><span class="pre">s2</span></code>?  We need to exit, <code class="docutils literal notranslate"><span class="pre">s11</span></code>,
then we need to exit <code class="docutils literal notranslate"><span class="pre">s1</span></code> then we need to enter <code class="docutils literal notranslate"><span class="pre">s2</span></code>.  Oh, and don’t forget
to run <code class="docutils literal notranslate"><span class="pre">g</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code> on the <code class="docutils literal notranslate"><span class="pre">T</span></code> event.  Here is a working theory:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> will run because <code class="docutils literal notranslate"><span class="pre">s11</span></code> needs to be exited.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> will run because <code class="docutils literal notranslate"><span class="pre">s1</span></code> needs to be exited.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g</span></code> will run because it is the guard for the <cite>T</cite> event between the <code class="docutils literal notranslate"><span class="pre">s1</span></code> and <code class="docutils literal notranslate"><span class="pre">s2</span></code> states.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> will run (assuming that <code class="docutils literal notranslate"><span class="pre">g</span></code> returned true)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> will run because <code class="docutils literal notranslate"><span class="pre">s2</span></code> needs to be entered.</p></li>
</ol>
</section>
<section id="a-better-answer">
<h2>A Better Answer<a class="headerlink" href="#a-better-answer" title="Permalink to this heading">#</a></h2>
<p>Now that we have a partial answer, let’s re-ask the question:</p>
<p>“Suppose we started the above chart in <code class="docutils literal notranslate"><span class="pre">s11</span></code>, then we send a <code class="docutils literal notranslate"><span class="pre">T</span></code> event to it,
when would each of the functions, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, and <code class="docutils literal notranslate"><span class="pre">t</span></code> happen?”</p>
<a class="reference external image-reference" href="_static/scribble.pdf"><img alt="_images/scribble.svg" class="noscale-center" src="_images/scribble.svg" /></a>
<p>If we look at the <code class="docutils literal notranslate"><span class="pre">s2</span></code> state, we see that it has an initialization event
(black dot) with another function <code class="docutils literal notranslate"><span class="pre">d</span></code> hanging on it .  After <code class="docutils literal notranslate"><span class="pre">s2</span></code> is
entered, we would expect the next thing to be a transition into the <code class="docutils literal notranslate"><span class="pre">s21</span></code>
state, but first we would run the <code class="docutils literal notranslate"><span class="pre">d</span></code> function on the arrow tied to the black
dot, since it is outside of the <code class="docutils literal notranslate"><span class="pre">s21</span></code> state and we haven’t entered it yet.
Let’s add this to our working theory:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> will run because <code class="docutils literal notranslate"><span class="pre">s11</span></code> needs to be exited.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> will run because <code class="docutils literal notranslate"><span class="pre">s1</span></code> needs to be exited.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g</span></code> will run because it is the guard for the <cite>T</cite> event between the <code class="docutils literal notranslate"><span class="pre">s1</span></code> and <code class="docutils literal notranslate"><span class="pre">s2</span></code> states.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> will run (assuming that <code class="docutils literal notranslate"><span class="pre">g</span></code> returned true)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> will run because <code class="docutils literal notranslate"><span class="pre">s2</span></code> needs to be entered.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> will run on the init transition event from <code class="docutils literal notranslate"><span class="pre">s2</span></code> to <code class="docutils literal notranslate"><span class="pre">s21</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e</span></code> will run because the <code class="docutils literal notranslate"><span class="pre">s21</span></code> needs to be entered.</p></li>
</ol>
</section>
<section id="our-first-working-hypothesis">
<h2>Our First Working Hypothesis<a class="headerlink" href="#our-first-working-hypothesis" title="Permalink to this heading">#</a></h2>
<p>“Suppose we started the above chart in <code class="docutils literal notranslate"><span class="pre">s11</span></code>, then we send a <code class="docutils literal notranslate"><span class="pre">T</span></code> event to it,
when would each of the functions, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, and <code class="docutils literal notranslate"><span class="pre">t</span></code> happen?”</p>
<a class="reference external image-reference" href="_static/scribble.pdf"><img alt="_images/scribble.svg" class="noscale-center" src="_images/scribble.svg" /></a>
<p>Ok, our thinking is a bit clearer now but let’s tighten up our answer.  There are
actually two parts, because the guard can return True or False.  We will start with the
easy part of the answer, then explain the longer part of the answer:</p>
<ol class="arabic simple">
<li><p>If g() returns False, none of the functions are called.</p></li>
<li><p>If g() returns True, then…  wait <code class="docutils literal notranslate"><span class="pre">g</span></code> had to be called first? Hmm.. whatever, here is
my theory so far:  <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>.  It is
easy to answer this way because my eyes work that way when I’m looking at
the picture.</p></li>
</ol>
<p>But, there is something nagging at me now: <code class="docutils literal notranslate"><span class="pre">g</span></code> had to be called first, otherwise
my answer doesn’t really make any sense.  So, here is my answer:</p>
<ol class="arabic simple">
<li><p>If g() returns False, only <code class="docutils literal notranslate"><span class="pre">g</span></code> is called</p></li>
<li><p>If g() returns True, then <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>.</p></li>
</ol>
<p>We have our theory, but we are hackers not philosophers.  We have more work to
do.  Hackers ruthlessly deploy the scientific method to seek understanding
about things they care about.  Hackers do four hard things over and over again:</p>
<ol class="arabic simple">
<li><p>Think</p></li>
<li><p>Move past technical boundaries</p></li>
<li><p>Destroy their own theories by seeking contrary evidence</p></li>
<li><p>Learn from their mistakes</p></li>
</ol>
<p>Now that I think I understand how the statechart works, I have performed the
first thing on the list.  To try and disprove my theory, I will need to build
up the statechart in the diagram and actually see what happens.</p>
</section>
<section id="code-make-a-picture">
<span id="scribbleexample-from-diagram-to-code-first-pass"></span><h2>Code, Make a Picture<a class="headerlink" href="#code-make-a-picture" title="Permalink to this heading">#</a></h2>
<p>To begin with I will draw the picture in the code, so that as I work I can see
what I’m trying to build:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">+----------------------------- s -------------------------------+</span>
<span class="sd">| +-------- s1 ---------+                 +-------- s2 -------+ |</span>
<span class="sd">| | exit / b()          |                 | entry / c()       | |</span>
<span class="sd">| |    +--- s11 ----+   |                 |  +---- s21 -----+ | |</span>
<span class="sd">| |    | exit / a() |   |                 |  | entry / e()  | | |</span>
<span class="sd">| |    |            |   |                 |  |              | | |</span>
<span class="sd">| |    |            |   +- T [g()] / t() -&gt;  |              | | |</span>
<span class="sd">| |    +------------+   |                 |  +-----------/--+ | |</span>
<span class="sd">| |                     |                 |   *-- / d() -+    | |</span>
<span class="sd">| +---------------------+                 +-------------------+ |</span>
<span class="sd">+---------------------------------------------------------------+</span>

<span class="sd">&#39;&#39;&#39;</span>
</pre></div>
</div>
</section>
<section id="code-required-imports">
<span id="scribbleexample-from-diagram-to-code-second-pass"></span><h2>Code, Required Imports<a class="headerlink" href="#code-required-imports" title="Permalink to this heading">#</a></h2>
<p>Now I’ll import the items I’ll need to run my experiment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">+----------------------------- s -------------------------------+</span>
<span class="sd">| +-------- s1 ---------+                 +-------- s2 -------+ |</span>
<span class="sd">| | exit / b()          |                 | entry / c()       | |</span>
<span class="sd">| |    +--- s11 ----+   |                 |  +---- s21 -----+ | |</span>
<span class="sd">| |    | exit / a() |   |                 |  | entry / e()  | | |</span>
<span class="sd">| |    |            |   |                 |  |              | | |</span>
<span class="sd">| |    |            |   +- T [g()] / t() -&gt;  |              | | |</span>
<span class="sd">| |    +------------+   |                 |  +-----------/--+ | |</span>
<span class="sd">| |                     |                 |   *-- / d() -+    | |</span>
<span class="sd">| +---------------------+                 +-------------------+ |</span>
<span class="sd">+---------------------------------------------------------------+</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="hll"><span class="kn">import</span> <span class="nn">time</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">spy_on</span><span class="p">,</span> <span class="n">pp</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">ActiveObject</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">signals</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">return_status</span>
</span></pre></div>
</div>
</section>
<section id="code-frame-in-the-states">
<span id="scribbleexample-from-diagram-to-code-third-pass"></span><h2>Code, Frame in the States<a class="headerlink" href="#code-frame-in-the-states" title="Permalink to this heading">#</a></h2>
<p>Now I will frame in the state methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">+----------------------------- s -------------------------------+</span>
<span class="sd">| +-------- s1 ---------+                 +-------- s2 -------+ |</span>
<span class="sd">| | exit / b()          |                 | entry / c()       | |</span>
<span class="sd">| |    +--- s11 ----+   |                 |  +---- s21 -----+ | |</span>
<span class="sd">| |    | exit / a() |   |                 |  | entry / e()  | | |</span>
<span class="sd">| |    |            |   |                 |  |              | | |</span>
<span class="sd">| |    |            |   +- T [g()] / t() -&gt;  |              | | |</span>
<span class="sd">| |    +------------+   |                 |  +-----------/--+ | |</span>
<span class="sd">| |                     |                 |   *-- / d() -+    | |</span>
<span class="sd">| +---------------------+                 +-------------------+ |</span>
<span class="sd">+---------------------------------------------------------------+</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">spy_on</span><span class="p">,</span> <span class="n">pp</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">ActiveObject</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">signals</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">return_status</span>

<span class="hll"><span class="nd">@spy_on</span>
</span><span class="hll"><span class="k">def</span> <span class="nf">s_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span class="hll">  <span class="k">pass</span>
</span>
<span class="hll"><span class="nd">@spy_on</span>
</span><span class="hll"><span class="k">def</span> <span class="nf">s1_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span class="hll">  <span class="k">pass</span>
</span>
<span class="hll"><span class="nd">@spy_on</span>
</span><span class="hll"><span class="k">def</span> <span class="nf">s11_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span class="hll">  <span class="k">pass</span>
</span>
<span class="hll"><span class="nd">@spy_on</span>
</span><span class="hll"><span class="k">def</span> <span class="nf">s2_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span class="hll">  <span class="k">pass</span>
</span>
<span class="hll"><span class="nd">@spy_on</span>
</span><span class="hll"><span class="k">def</span> <span class="nf">s21_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span class="hll">  <span class="k">pass</span>
</span></pre></div>
</div>
</section>
<section id="code-add-common-internal-state-code">
<span id="scribbleexample-from-diagram-to-code-fourth-pass"></span><h2>Code, Add Common Internal State Code<a class="headerlink" href="#code-add-common-internal-state-code" title="Permalink to this heading">#</a></h2>
<p>Now I add the internal-event-handling code into each of the state
methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">+----------------------------- s -------------------------------+</span>
<span class="sd">| +-------- s1 ---------+                 +-------- s2 -------+ |</span>
<span class="sd">| | exit / b()          |                 | entry / c()       | |</span>
<span class="sd">| |    +--- s11 ----+   |                 |  +---- s21 -----+ | |</span>
<span class="sd">| |    | exit / a() |   |                 |  | entry / e()  | | |</span>
<span class="sd">| |    |            |   |                 |  |              | | |</span>
<span class="sd">| |    |            |   +- T [g()] / t() -&gt;  |              | | |</span>
<span class="sd">| |    +------------+   |                 |  +-----------/--+ | |</span>
<span class="sd">| |                     |                 |   *-- / d() -+    | |</span>
<span class="sd">| +---------------------+                 +-------------------+ |</span>
<span class="sd">+---------------------------------------------------------------+</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">spy_on</span><span class="p">,</span> <span class="n">pp</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">ActiveObject</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">signals</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">return_status</span>

<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="hll">  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
</span><span class="hll">
</span><span class="hll">  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">else</span><span class="p">:</span>
</span><span class="hll">    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
</span><span class="hll">  <span class="k">return</span> <span class="n">status</span>
</span>
<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s1_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="hll">  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
</span><span class="hll">
</span><span class="hll">  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">else</span><span class="p">:</span>
</span><span class="hll">    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
</span><span class="hll">  <span class="k">return</span> <span class="n">status</span>
</span>
<span class="nd">@spy_on</span>
<span class="hll"><span class="k">def</span> <span class="nf">s11_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span class="hll">  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
</span><span class="hll">
</span><span class="hll">  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">else</span><span class="p">:</span>
</span><span class="hll">    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
</span><span class="hll">  <span class="k">return</span> <span class="n">status</span>
</span>
<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s2_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="hll">  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
</span><span class="hll">
</span><span class="hll">  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">else</span><span class="p">:</span>
</span><span class="hll">    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
</span><span class="hll">  <span class="k">return</span> <span class="n">status</span>
</span>
<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s21_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="hll">  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
</span><span class="hll">
</span><span class="hll">  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
</span><span class="hll">  <span class="k">else</span><span class="p">:</span>
</span><span class="hll">    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
</span><span class="hll">  <span class="k">return</span> <span class="n">status</span>
</span></pre></div>
</div>
</section>
<section id="code-add-hiearchy">
<span id="scribbleexample-from-diagram-to-code-fifth-pass"></span><h2>Code, Add Hiearchy<a class="headerlink" href="#code-add-hiearchy" title="Permalink to this heading">#</a></h2>
<p>Then I add the hierarchy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">+----------------------------- s -------------------------------+</span>
<span class="sd">| +-------- s1 ---------+                 +-------- s2 -------+ |</span>
<span class="sd">| | exit / b()          |                 | entry / c()       | |</span>
<span class="sd">| |    +--- s11 ----+   |                 |  +---- s21 -----+ | |</span>
<span class="sd">| |    | exit / a() |   |                 |  | entry / e()  | | |</span>
<span class="sd">| |    |            |   |                 |  |              | | |</span>
<span class="sd">| |    |            |   +- T [g()] / t() -&gt;  |              | | |</span>
<span class="sd">| |    +------------+   |                 |  +-----------/--+ | |</span>
<span class="sd">| |                     |                 |   *-- / d() -+    | |</span>
<span class="sd">| +---------------------+                 +-------------------+ |</span>
<span class="sd">+---------------------------------------------------------------+</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">spy_on</span><span class="p">,</span> <span class="n">pp</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">ActiveObject</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">signals</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">return_status</span>

<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
<span class="hll">    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
</span>  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s1_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">a</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
<span class="hll">    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
</span>  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s11_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s1_state</span>
<span class="hll">  <span class="k">return</span> <span class="n">status</span>
</span>

<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s2_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
<span class="hll">  <span class="k">return</span> <span class="n">status</span>
</span>

<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s21_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s2_state</span>
<span class="hll">  <span class="k">return</span> <span class="n">status</span>
</span></pre></div>
</div>
</section>
<section id="code-add-the-t-and-init-events">
<span id="scribbleexample-from-diagram-to-code-sixth-pass"></span><h2>Code, Add the T and Init events<a class="headerlink" href="#code-add-the-t-and-init-events" title="Permalink to this heading">#</a></h2>
<p>Now I’ll add management for the <code class="docutils literal notranslate"><span class="pre">T</span></code> event in state <code class="docutils literal notranslate"><span class="pre">s1</span></code> event and the
<code class="docutils literal notranslate"><span class="pre">init</span></code> event needed in <code class="docutils literal notranslate"><span class="pre">s2</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">+----------------------------- s -------------------------------+</span>
<span class="sd">| +-------- s1 ---------+                 +-------- s2 -------+ |</span>
<span class="sd">| | exit / b()          |                 | entry / c()       | |</span>
<span class="sd">| |    +--- s11 ----+   |                 |  +---- s21 -----+ | |</span>
<span class="sd">| |    | exit / a() |   |                 |  | entry / e()  | | |</span>
<span class="sd">| |    |            |   |                 |  |              | | |</span>
<span class="sd">| |    |            |   +- T [g()] / t() -&gt;  |              | | |</span>
<span class="sd">| |    +------------+   |                 |  +-----------/--+ | |</span>
<span class="sd">| |                     |                 |   *-- / d() -+    | |</span>
<span class="sd">| +---------------------+                 +-------------------+ |</span>
<span class="sd">+---------------------------------------------------------------+</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">spy_on</span><span class="p">,</span> <span class="n">pp</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">ActiveObject</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">signals</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">return_status</span>

<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s1_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">a</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="hll">  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">s2_state</span><span class="p">)</span>
</span>  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s11_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s1_state</span>
  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s2_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="hll">  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">INIT_SIGNAL</span><span class="p">):</span>
</span><span class="hll">    <span class="n">status</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">s21_state</span><span class="p">)</span>
</span>  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s21_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s2_state</span>
  <span class="k">return</span> <span class="n">status</span>
</pre></div>
</div>
</section>
<section id="code-see-if-anything-runs">
<span id="scribbleexample-from-diagram-to-code-eighth-pass"></span><h2>Code, See if anything Runs<a class="headerlink" href="#code-see-if-anything-runs" title="Permalink to this heading">#</a></h2>
<p>Now it is time to turn on this hierarchy by giving it to an active object and
seeing what happens:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="sd">&#39;&#39;&#39;</span>
<span class="linenos"> 2</span><span class="sd">+----------------------------- s -------------------------------+</span>
<span class="linenos"> 3</span><span class="sd">| +-------- s1 ---------+                 +-------- s2 -------+ |</span>
<span class="linenos"> 4</span><span class="sd">| | exit / b()          |                 | entry / c()       | |</span>
<span class="linenos"> 5</span><span class="sd">| |    +--- s11 ----+   |                 |  +---- s21 -----+ | |</span>
<span class="linenos"> 6</span><span class="sd">| |    | exit / a() |   |                 |  | entry / e()  | | |</span>
<span class="linenos"> 7</span><span class="sd">| |    |            |   |                 |  |              | | |</span>
<span class="linenos"> 8</span><span class="sd">| |    |            |   +- T [g()] / t() -&gt;  |              | | |</span>
<span class="linenos"> 9</span><span class="sd">| |    +------------+   |                 |  +-----------/--+ | |</span>
<span class="linenos">10</span><span class="sd">| |                     |                 |   *-- / d() -+    | |</span>
<span class="linenos">11</span><span class="sd">| +---------------------+                 +-------------------+ |</span>
<span class="linenos">12</span><span class="sd">+---------------------------------------------------------------+</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="sd">&#39;&#39;&#39;</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="kn">import</span> <span class="nn">time</span>
<span class="linenos">17</span><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">spy_on</span><span class="p">,</span> <span class="n">pp</span>
<span class="linenos">18</span><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">ActiveObject</span>
<span class="linenos">19</span><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">signals</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">return_status</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="nd">@spy_on</span>
<span class="linenos">22</span><span class="k">def</span> <span class="nf">s_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="linenos">23</span><span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="linenos">26</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">27</span><span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="linenos">28</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">29</span><span class="k">else</span><span class="p">:</span>
<span class="linenos">30</span>  <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
<span class="linenos">31</span><span class="k">return</span> <span class="n">status</span>
<span class="linenos">32</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="nd">@spy_on</span>
<span class="linenos">35</span><span class="k">def</span> <span class="nf">s1_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="linenos">36</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos">37</span>
<span class="linenos">38</span>  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="linenos">39</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">40</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="linenos">41</span>    <span class="n">a</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
<span class="linenos">42</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">43</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
<span class="linenos">44</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">s2_state</span><span class="p">)</span>
<span class="linenos">45</span>  <span class="k">else</span><span class="p">:</span>
<span class="linenos">46</span>    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
<span class="linenos">47</span>  <span class="k">return</span> <span class="n">status</span>
<span class="linenos">48</span>
<span class="linenos">49</span>
<span class="linenos">50</span><span class="nd">@spy_on</span>
<span class="linenos">51</span><span class="k">def</span> <span class="nf">s11_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="linenos">52</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos">53</span>
<span class="linenos">54</span>  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="linenos">55</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">56</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="linenos">57</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">58</span>  <span class="k">else</span><span class="p">:</span>
<span class="linenos">59</span>    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s1_state</span>
<span class="linenos">60</span>  <span class="k">return</span> <span class="n">status</span>
<span class="linenos">61</span>
<span class="linenos">62</span>
<span class="linenos">63</span><span class="nd">@spy_on</span>
<span class="linenos">64</span><span class="k">def</span> <span class="nf">s2_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="linenos">65</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos">66</span>
<span class="linenos">67</span>  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="linenos">68</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">69</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="linenos">70</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">71</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">INIT_SIGNAL</span><span class="p">):</span>
<span class="linenos">72</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">s21_state</span><span class="p">)</span>
<span class="linenos">73</span>  <span class="k">else</span><span class="p">:</span>
<span class="linenos">74</span>    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
<span class="linenos">75</span>  <span class="k">return</span> <span class="n">status</span>
<span class="linenos">76</span>
<span class="linenos">77</span>
<span class="linenos">78</span><span class="nd">@spy_on</span>
<span class="linenos">79</span><span class="k">def</span> <span class="nf">s21_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="linenos">80</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos">81</span>
<span class="linenos">82</span>  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="linenos">83</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">84</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="linenos">85</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">86</span>  <span class="k">else</span><span class="p">:</span>
<span class="linenos">87</span>    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s2_state</span>
<span class="linenos">88</span>  <span class="k">return</span> <span class="n">status</span>
<span class="linenos">89</span>
<span class="linenos">90</span>
<span class="linenos">91</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">92</span>  <span class="n">ao</span> <span class="o">=</span> <span class="n">ActiveObject</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;T_question&quot;</span><span class="p">)</span>
<span class="linenos">93</span>  <span class="n">ao</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="n">s11_state</span><span class="p">)</span>
<span class="linenos">94</span>  <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="linenos">95</span>  <span class="n">pp</span><span class="p">(</span><span class="n">ao</span><span class="o">.</span><span class="n">spy</span><span class="p">())</span>
</pre></div>
</div>
<p>Notice, we sleep for a very short time to let the active object thread detect that
it has received an instruction.</p>
<p id="scribbleexample">When we run this code it outputs:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="s1">&#39;START&#39;</span>,
 <span class="s1">&#39;SEARCH_FOR_SUPER_SIGNAL:s11_state&#39;</span>,
 <span class="s1">&#39;SEARCH_FOR_SUPER_SIGNAL:s1_state&#39;</span>,
 <span class="s1">&#39;SEARCH_FOR_SUPER_SIGNAL:s_state&#39;</span>,
 <span class="s1">&#39;ENTRY_SIGNAL:s_state&#39;</span>,
 <span class="s1">&#39;ENTRY_SIGNAL:s1_state&#39;</span>,
 <span class="s1">&#39;ENTRY_SIGNAL:s11_state&#39;</span>,
 <span class="s1">&#39;INIT_SIGNAL:s11_state&#39;</span>,
 <span class="s1">&#39;&lt;- Queued:(0) Deferred:(0)&#39;</span><span class="o">]</span>
</pre></div>
</div>
<p>Good, our start is structured well enough that it can run.</p>
</section>
<section id="code-add-the-guard-and-t-function">
<span id="scribbleexample-from-diagram-to-code-ninth-pass"></span><h2>Code, Add the guard and t function<a class="headerlink" href="#code-add-the-guard-and-t-function" title="Permalink to this heading">#</a></h2>
<p>Now lets add the guard function <code class="docutils literal notranslate"><span class="pre">g</span></code> and the <code class="docutils literal notranslate"><span class="pre">t</span></code> function into s1_state,
this will build this part of the picture:</p>
<img alt="_images/guard2.svg" class="noscale-left" src="_images/guard2.svg" /><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">+----------------------------- s -------------------------------+</span>
<span class="sd">| +-------- s1 ---------+                 +-------- s2 -------+ |</span>
<span class="sd">| | exit / b()          |                 | entry / c()       | |</span>
<span class="sd">| |    +--- s11 ----+   |                 |  +---- s21 -----+ | |</span>
<span class="sd">| |    | exit / a() |   |                 |  | entry / e()  | | |</span>
<span class="sd">| |    |            |   |                 |  |              | | |</span>
<span class="sd">| |    |            |   +- T [g()] / t() -&gt;  |              | | |</span>
<span class="sd">| |    +------------+   |                 |  +-----------/--+ | |</span>
<span class="sd">| |                     |                 |   *-- / d() -+    | |</span>
<span class="sd">| +---------------------+                 +-------------------+ |</span>
<span class="sd">+---------------------------------------------------------------+</span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">spy_on</span><span class="p">,</span> <span class="n">pp</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">ActiveObject</span>
<span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">signals</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">return_status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s1_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="hll">  <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
</span><span class="hll">    <span class="n">chart</span><span class="o">.</span><span class="n">scribble</span><span class="p">(</span><span class="s2">&quot;Running g() -- the guard, which returns True&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">return</span> <span class="kc">True</span>
</span><span class="hll">
</span><span class="hll">  <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
</span><span class="hll">    <span class="n">chart</span><span class="o">.</span><span class="n">scribble</span><span class="p">(</span><span class="s2">&quot;Running t() -- function run on event T&quot;</span><span class="p">)</span>
</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
      <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="hll">  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
</span><span class="hll">    <span class="k">if</span> <span class="n">g</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
</span><span class="hll">      <span class="n">t</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span class="hll">      <span class="n">status</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">s2_state</span><span class="p">)</span>
</span>  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s11_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s1_state</span>
  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s2_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">INIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">s21_state</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
  <span class="k">return</span> <span class="n">status</span>


<span class="nd">@spy_on</span>
<span class="k">def</span> <span class="nf">s21_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>

  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s2_state</span>
  <span class="k">return</span> <span class="n">status</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
  <span class="n">ao</span> <span class="o">=</span> <span class="n">ActiveObject</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;T_question&quot;</span><span class="p">)</span>
  <span class="n">ao</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="n">s11_state</span><span class="p">)</span>
  <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">pp</span><span class="p">(</span><span class="n">ao</span><span class="o">.</span><span class="n">spy</span><span class="p">())</span>
</pre></div>
</div>
<p>The guard condition totally makes sense when you look it it in Python.</p>
<p>Functions <code class="docutils literal notranslate"><span class="pre">g</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code> use the chart’s <code class="docutils literal notranslate"><span class="pre">scribble</span></code> method which puts little
notes directly into the spy output log.  We do this so that our tests will
reveal exactly when <code class="docutils literal notranslate"><span class="pre">g</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code> are called by the event processor.</p>
</section>
<section id="code-add-the-other-functions">
<span id="scribbleexample-from-diagram-to-code-tenth-pass"></span><h2>Code, Add the other functions<a class="headerlink" href="#code-add-the-other-functions" title="Permalink to this heading">#</a></h2>
<p>Now let’s frame <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>. Notice we re-name the <code class="docutils literal notranslate"><span class="pre">e</span></code>
function to <code class="docutils literal notranslate"><span class="pre">e_function</span></code> to avoid a name collision:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="sd">&#39;&#39;&#39;</span>
<span class="linenos">  2</span><span class="sd">+----------------------------- s -------------------------------+</span>
<span class="linenos">  3</span><span class="sd">| +-------- s1 ---------+                 +-------- s2 -------+ |</span>
<span class="linenos">  4</span><span class="sd">| | exit / b()          |                 | entry / c()       | |</span>
<span class="linenos">  5</span><span class="sd">| |    +--- s11 ----+   |                 |  +---- s21 -----+ | |</span>
<span class="linenos">  6</span><span class="sd">| |    | exit / a() |   |                 |  | entry / e()  | | |</span>
<span class="linenos">  7</span><span class="sd">| |    |            |   |                 |  |              | | |</span>
<span class="linenos">  8</span><span class="sd">| |    |            |   +- T [g()] / t() -&gt;  |              | | |</span>
<span class="linenos">  9</span><span class="sd">| |    +------------+   |                 |  +-----------/--+ | |</span>
<span class="linenos"> 10</span><span class="sd">| |                     |                 |   *-- / d() -+    | |</span>
<span class="linenos"> 11</span><span class="sd">| +---------------------+                 +-------------------+ |</span>
<span class="linenos"> 12</span><span class="sd">+---------------------------------------------------------------+</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="sd">&#39;&#39;&#39;</span>
<span class="linenos"> 15</span>
<span class="linenos"> 16</span><span class="kn">import</span> <span class="nn">time</span>
<span class="linenos"> 17</span><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">spy_on</span><span class="p">,</span> <span class="n">pp</span>
<span class="linenos"> 18</span><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">ActiveObject</span>
<span class="linenos"> 19</span><span class="kn">from</span> <span class="nn">miros</span> <span class="kn">import</span> <span class="n">signals</span><span class="p">,</span> <span class="n">Event</span><span class="p">,</span> <span class="n">return_status</span>
<span class="linenos"> 20</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="nd">@spy_on</span>
<span class="linenos"> 23</span><span class="k">def</span> <span class="nf">s_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="linenos"> 24</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos"> 25</span>
<span class="linenos"> 26</span>  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="linenos"> 27</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos"> 28</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="linenos"> 29</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos"> 30</span>  <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 31</span>    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">top</span>
<span class="linenos"> 32</span>  <span class="k">return</span> <span class="n">status</span>
<span class="linenos"> 33</span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span><span class="nd">@spy_on</span>
<span class="linenos"> 36</span><span class="k">def</span> <span class="nf">s1_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="hll"><span class="linenos"> 37</span>  <span class="k">def</span> <span class="nf">b</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
</span><span class="hll"><span class="linenos"> 38</span>    <span class="n">chart</span><span class="o">.</span><span class="n">scribble</span><span class="p">(</span><span class="s2">&quot;Running b()&quot;</span><span class="p">)</span>
</span><span class="linenos"> 39</span>
<span class="linenos"> 40</span>  <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
<span class="linenos"> 41</span>    <span class="n">chart</span><span class="o">.</span><span class="n">scribble</span><span class="p">(</span><span class="s2">&quot;Running g() -- the guard, which returns True&quot;</span><span class="p">)</span>
<span class="linenos"> 42</span>    <span class="k">return</span> <span class="kc">True</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span>  <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
<span class="linenos"> 45</span>    <span class="n">chart</span><span class="o">.</span><span class="n">scribble</span><span class="p">(</span><span class="s2">&quot;Running t() -- function run on event T&quot;</span><span class="p">)</span>
<span class="linenos"> 46</span>
<span class="linenos"> 47</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span>  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="linenos"> 50</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos"> 51</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="hll"><span class="linenos"> 52</span>    <span class="n">b</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span class="linenos"> 53</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos"> 54</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
<span class="linenos"> 55</span>    <span class="k">if</span> <span class="n">g</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
<span class="linenos"> 56</span>      <span class="n">t</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
<span class="linenos"> 57</span>      <span class="n">status</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">s2_state</span><span class="p">)</span>
<span class="linenos"> 58</span>  <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 59</span>    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
<span class="linenos"> 60</span>  <span class="k">return</span> <span class="n">status</span>
<span class="linenos"> 61</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span><span class="nd">@spy_on</span>
<span class="linenos"> 64</span><span class="k">def</span> <span class="nf">s11_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="hll"><span class="linenos"> 65</span>  <span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
</span><span class="hll"><span class="linenos"> 66</span>    <span class="n">chart</span><span class="o">.</span><span class="n">scribble</span><span class="p">(</span><span class="s2">&quot;Running a()&quot;</span><span class="p">)</span>
</span><span class="linenos"> 67</span>
<span class="linenos"> 68</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos"> 69</span>
<span class="linenos"> 70</span>  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="linenos"> 71</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos"> 72</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="hll"><span class="linenos"> 73</span>    <span class="n">a</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span class="linenos"> 74</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos"> 75</span>  <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 76</span>    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s1_state</span>
<span class="linenos"> 77</span>  <span class="k">return</span> <span class="n">status</span>
<span class="linenos"> 78</span>
<span class="linenos"> 79</span>
<span class="linenos"> 80</span><span class="nd">@spy_on</span>
<span class="linenos"> 81</span><span class="k">def</span> <span class="nf">s2_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="hll"><span class="linenos"> 82</span>  <span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
</span><span class="hll"><span class="linenos"> 83</span>    <span class="n">chart</span><span class="o">.</span><span class="n">scribble</span><span class="p">(</span><span class="s2">&quot;running c()&quot;</span><span class="p">)</span>
</span><span class="linenos"> 84</span>
<span class="hll"><span class="linenos"> 85</span>  <span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
</span><span class="hll"><span class="linenos"> 86</span>    <span class="n">chart</span><span class="o">.</span><span class="n">scribble</span><span class="p">(</span><span class="s2">&quot;running d()&quot;</span><span class="p">)</span>
</span><span class="linenos"> 87</span>
<span class="linenos"> 88</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos"> 89</span>
<span class="linenos"> 90</span>  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="hll"><span class="linenos"> 91</span>    <span class="n">c</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span class="linenos"> 92</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos"> 93</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="linenos"> 94</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos"> 95</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">INIT_SIGNAL</span><span class="p">):</span>
<span class="hll"><span class="linenos"> 96</span>    <span class="n">d</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span class="linenos"> 97</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">chart</span><span class="o">.</span><span class="n">trans</span><span class="p">(</span><span class="n">s21_state</span><span class="p">)</span>
<span class="linenos"> 98</span>  <span class="k">else</span><span class="p">:</span>
<span class="linenos"> 99</span>    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s_state</span>
<span class="linenos">100</span>  <span class="k">return</span> <span class="n">status</span>
<span class="linenos">101</span>
<span class="linenos">102</span>
<span class="linenos">103</span><span class="nd">@spy_on</span>
<span class="linenos">104</span><span class="k">def</span> <span class="nf">s21_state</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
<span class="hll"><span class="linenos">105</span>  <span class="k">def</span> <span class="nf">e_function</span><span class="p">(</span><span class="n">chart</span><span class="p">):</span>
</span><span class="hll"><span class="linenos">106</span>    <span class="n">chart</span><span class="o">.</span><span class="n">scribble</span><span class="p">(</span><span class="s2">&quot;running e()&quot;</span><span class="p">)</span>
</span><span class="linenos">107</span>
<span class="linenos">108</span>  <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">UNHANDLED</span>
<span class="linenos">109</span>
<span class="linenos">110</span>  <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">ENTRY_SIGNAL</span><span class="p">):</span>
<span class="hll"><span class="linenos">111</span>    <span class="n">e_function</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</span><span class="linenos">112</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">113</span>  <span class="k">elif</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">signal</span> <span class="o">==</span> <span class="n">signals</span><span class="o">.</span><span class="n">EXIT_SIGNAL</span><span class="p">):</span>
<span class="linenos">114</span>    <span class="n">status</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">HANDLED</span>
<span class="linenos">115</span>  <span class="k">else</span><span class="p">:</span>
<span class="linenos">116</span>    <span class="n">status</span><span class="p">,</span> <span class="n">chart</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">return_status</span><span class="o">.</span><span class="n">SUPER</span><span class="p">,</span> <span class="n">s2_state</span>
<span class="linenos">117</span>  <span class="k">return</span> <span class="n">status</span>
<span class="linenos">118</span>
<span class="linenos">119</span>
<span class="linenos">120</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">121</span>  <span class="n">ao</span> <span class="o">=</span> <span class="n">ActiveObject</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;T_question&quot;</span><span class="p">)</span>
<span class="linenos">122</span>  <span class="n">ao</span><span class="o">.</span><span class="n">start_at</span><span class="p">(</span><span class="n">s11_state</span><span class="p">)</span>
<span class="linenos">123</span>
<span class="hll"><span class="linenos">124</span>  <span class="n">ao</span><span class="o">.</span><span class="n">clear_spy</span><span class="p">()</span>
</span><span class="hll"><span class="linenos">125</span>  <span class="n">ao</span><span class="o">.</span><span class="n">post_fifo</span><span class="p">(</span><span class="n">Event</span><span class="p">(</span><span class="n">signal</span><span class="o">=</span><span class="n">signals</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
</span><span class="hll"><span class="linenos">126</span>  <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">127</span>  <span class="n">pp</span><span class="p">(</span><span class="n">ao</span><span class="o">.</span><span class="n">spy</span><span class="p">())</span>
</span></pre></div>
</div>
</section>
<section id="challenging-our-hypothesis">
<h2>Challenging Our Hypothesis<a class="headerlink" href="#challenging-our-hypothesis" title="Permalink to this heading">#</a></h2>
<p>Let’s bring our question and our hypothesis back into view so we can think
about it again:</p>
<p>“Suppose we started the above chart in <code class="docutils literal notranslate"><span class="pre">s11</span></code>, then we send a <code class="docutils literal notranslate"><span class="pre">T</span></code> event to it,
when would each of the functions, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, and <code class="docutils literal notranslate"><span class="pre">t</span></code> happen?”</p>
<a class="reference external image-reference" href="_static/scribble.pdf"><img alt="_images/scribble.svg" class="noscale-center" src="_images/scribble.svg" /></a>
<p>Our answer:
<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">g()</span> <span class="pre">returns</span> <span class="pre">True,</span> <span class="pre">then</span> <span class="pre">the</span> <span class="pre">function</span> <span class="pre">order</span> <span class="pre">will</span> <span class="pre">be:</span></code> <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code></p>
<p>Let’s examine my own personal psychological state.  I have been taking tiny
steps to keep my cognitive load light, and right now I’m feeling pretty good.
I have a theory, but more importantly I have built up some firm reality outside
of myself that I can push against.  My sense of possession has transfered from
my answer into the structure that will be used to attack this answer.</p>
<p>Moreover, I feel a sense of control and I’m feeling satisfaction from building
something.  The part of my mind that gets a buzz from pursuit, from seeking is
activated and I’m feeling ready to grok something about these statecharts.</p>
<p>If you have actually been doing the work and debugging your own code, well,
maybe you feel this too.</p>
<p>Now, let’s pull the trigger and see what happens.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;T:s11_state&#39;</span><span class="p">,</span>
 <span class="s1">&#39;T:s1_state&#39;</span><span class="p">,</span>
<span class="hll"> <span class="s1">&#39;Running g() -- the guard, which return True&#39;</span><span class="p">,</span>
</span><span class="hll"> <span class="s1">&#39;Running t() -- function run on event T&#39;</span><span class="p">,</span>
</span> <span class="s1">&#39;EXIT_SIGNAL:s11_state&#39;</span><span class="p">,</span>
<span class="hll"> <span class="s1">&#39;Running a()&#39;</span><span class="p">,</span>
</span> <span class="s1">&#39;SEARCH_FOR_SUPER_SIGNAL:s11_state&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SEARCH_FOR_SUPER_SIGNAL:s2_state&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SEARCH_FOR_SUPER_SIGNAL:s1_state&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EXIT_SIGNAL:s1_state&#39;</span><span class="p">,</span>
<span class="hll"> <span class="s1">&#39;Running b()&#39;</span><span class="p">,</span>
</span> <span class="s1">&#39;ENTRY_SIGNAL:s2_state&#39;</span><span class="p">,</span>
<span class="hll"> <span class="s1">&#39;running c()&#39;</span><span class="p">,</span>
</span> <span class="s1">&#39;INIT_SIGNAL:s2_state&#39;</span><span class="p">,</span>
<span class="hll"> <span class="s1">&#39;running d()&#39;</span><span class="p">,</span>
</span> <span class="s1">&#39;SEARCH_FOR_SUPER_SIGNAL:s21_state&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ENTRY_SIGNAL:s21_state&#39;</span><span class="p">,</span>
<span class="hll"> <span class="s1">&#39;running e()&#39;</span><span class="p">,</span>
</span> <span class="s1">&#39;INIT_SIGNAL:s21_state&#39;</span><span class="p">,</span>
 <span class="s1">&#39;&lt;- Queued:(0) Deferred:(0)&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Look, it’s different.  We got an order of: <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>,
<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>.</p>
<p>The answer:
<code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>.</p>
<p>Now let’s see what happens when we adjust the <code class="docutils literal notranslate"><span class="pre">g</span></code> function to return a False:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;T:s11_state&#39;</span><span class="p">,</span>
 <span class="s1">&#39;T:s1_state&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Running g() -- the guard, which return False&#39;</span><span class="p">,</span>
 <span class="s1">&#39;&lt;- Queued:(0) Deferred:(0)&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now that we understand that, let’s re-ask the question:</p>
<p>“Suppose we started the above chart in <code class="docutils literal notranslate"><span class="pre">s11</span></code>, then we send a <code class="docutils literal notranslate"><span class="pre">T</span></code> event to it,
when would each of the functions, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, and <code class="docutils literal notranslate"><span class="pre">t</span></code> happen?”</p>
<a class="reference external image-reference" href="_static/scribble.pdf"><img alt="_images/scribble.svg" class="noscale-center" src="_images/scribble.svg" /></a>
<ol class="arabic simple">
<li><p>If g() returns False, only <code class="docutils literal notranslate"><span class="pre">g</span></code> is called</p></li>
<li><p>If g() returns True, then <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>.</p></li>
</ol>
<p>We know this, because we just confirmed the behavior.</p>
</section>
<section id="learning-for-my-mistake">
<h2>Learning for my Mistake<a class="headerlink" href="#learning-for-my-mistake" title="Permalink to this heading">#</a></h2>
<p>If you are deeply familiar with the UML specification for statecharts, you will
see that our observed behavior is an infraction.  The original answer was
supposed to describe the behavior.  The good news is that this event processor
algorithm is based on the work of Miros Samek.</p>
<a class="reference external image-reference" href="_static/scribble.pdf"><img alt="_images/scribble.svg" class="noscale-center" src="_images/scribble.svg" /></a>
<p>On pages 80-81 of his book titled <a class="reference external" href="https://www.amazon.ca/Practical-UML-Statecharts-Event-Driven-Programming/dp/0750687061/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1510515714&amp;sr=1-1&amp;dpID=51Uq%252BHZ9L-L&amp;preST=_SX198_BO1,204,203,200_QL40_&amp;dpSrc=srch">Practical UML Statecharts in C/C++ Second
Edition</a> he wrote:</p>
<blockquote>
<div><p>One big problem with UML transition sequence is that it requires executing
actions associated with the transition <cite>after</cite> destroying the source state
configuration but before creating the target state configuration.  In the
analogy between exit actions in state machines and destructors in OOP, this
situation corresponds to executing a class method after partially destroying an
object.  Of course, such action is illegal in OOP.  As it turns out, it is also
particularly awkward to implement for state machines.</p>
<p>Executing actions associated with a transition is much more natural in the
context of the source state – the same context in which the guard condition is
evaluated.  Only after the guard and the transition actions execute, the source
state configuration is exited and the target state configuration is entered
<cite>atomically</cite>.  That way the state machine is observable only in a safe state
configuration, either before or after the transition, but not in the middle.</p>
</div></blockquote>
<p>So, our <code class="docutils literal notranslate"><span class="pre">t</span></code> function runs within the context of the thing that asked for the
transition.  This keeps it out of the strange limbo state described above.</p>
<p>Let’s think about how we could re-adjust our thinking, by re-asking the
question and considering how we could approach it the next time we see
something like it.</p>
<p>“Suppose we started the above chart in <code class="docutils literal notranslate"><span class="pre">s11</span></code>, then we send a <code class="docutils literal notranslate"><span class="pre">T</span></code> event to it,
when would each of the functions, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, and <code class="docutils literal notranslate"><span class="pre">t</span></code> happen?”</p>
<a class="reference external image-reference" href="_static/scribble.pdf"><img alt="_images/scribble.svg" class="noscale-center" src="_images/scribble.svg" /></a>
<p>Knowing that the source state of our <code class="docutils literal notranslate"><span class="pre">T</span></code> event was <strong>s11</strong> you would first
re-imagine the diagram as:</p>
<a class="reference external image-reference" href="_static/scribble2.pdf"><img alt="_images/scribble2.svg" class="noscale-center" src="_images/scribble2.svg" /></a>
<p>Then the answer to the question would just reveal itself from your imagined diagram:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code> if <code class="docutils literal notranslate"><span class="pre">g</span></code> returns True</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g</span></code> if <code class="docutils literal notranslate"><span class="pre">g</span></code> returns False</p></li>
</ul>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>The S1 rectangle containing the two small rectangles with a line between them is short hand for a composite state</p>
</aside>
</aside>
</section>
</section>


        
        <div class="main-content__right-sidebar">
          <h2 class="sidebar-heading">On this page:</h2>
        </div>
      </div>
    </main>

    <div class="footer-wrapper">
      
      <footer class="main-footer main-footer--sidebar">
      
        <div class="relational-links">
          <div>
            
            ← <a class="relational-link" href="thread_safe_attributes.html" title="previous chapter">Thread Safe Attributes</a>
            
          </div>
          <div>
            
             <a class="relational-link" href="interactingcharts.html" title="next chapter">Interacting Statecharts (Same Machine)</a> →
            
          </div>
        </div>
        
        <div class="copyright">
          © Copyright <span class="js-year"></span>,
          
          <a href="https://github.com/aleph2c" class="copyright_link">Scott Volk</a>.
          
        </div>
        
        
        <div class="last-updated">
          <span class="prefix">Last updated:</span>
          <span class="time">May 28, 2024 8:03 AM</span>
        </div>
        
        
        <div class="created-with">
          Created using <a href="http://sphinx-doc.org/" class="copyright_link">Sphinx</a> 5.1.1 with <span class="theme">13ds_theme_one</span>.
        </div>
        
      </footer>
    </div>
  </body>
</html>