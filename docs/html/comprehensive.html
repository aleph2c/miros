







<!DOCTYPE html>
<html  lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Comprehensive | miros</title>
    <link rel="shortcut icon" href="_static/favicon.ico">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css">
    <link rel="stylesheet" href="_static/theme.css" type="text/css">
    
      
    <link rel="stylesheet" type="text/css" href="_static/css/miros_docs.css" />
      
    
    

    
    <script type="text/javascript" src="_static/theme.js" defer></script>
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    
    <script src="_static/jquery.js"></script>
    
    <script src="_static/underscore.js"></script>
    
    <script src="_static/doctools.js"></script>
    
    <script src="_static/language_data.js"></script>
    
    

    
      
      
    <link rel="index" title="Index" href="genindex.html">
      
      
    <link rel="search" title="Search" href="search.html">
      
      
      
    <link rel="next" title="Thread Safe Attributes" href="thread_safe_attributes.html">
      
      
    <link rel="prev" title="Examples" href="examples.html">
      
    

    

    

    
  </head>

  <body>
    <header class="main-header">
      <div class="navbar">
        <div id="js-sidebar-mask" class="sidebar-mask"></div>
        <div id="js-sidebar-menu-button" class="sidebar-menu-button">
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg>
        </div>
        <a href="index.html" class="site-link">
          
          miros
          
        </a>
        <div class="navbar-links">
          <a href="installation.html" class="navbar-link">Docs</a>
          
          <a href="https://github.com/aleph2c/miros" class="navbar-link">GitHub</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg>
          
        </div>
      </div>
    </header>

    <main class="main-wrapper">
      
      <div id="js-main-sidebar" class="main-sidebar">
        
        <div class="sidebar-content sidebar-content--divider sidebar-navbar-links">
          <a href="https://github.com/aleph2c/miros" class="sidebar-navbar-link">GitHub</a>
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg>
        </div>
        
        
        <div class="sidebar-content sidebar-logo">
    <a href="index.html">
      <img class="logo" src="_static/miros_logo.svg" alt="miros" >
    </a>
</div>
        
        

<h2 class="sidebar-heading">Contents</h2>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="zero_to_one.html">Tutorial: Zero to One</a></li>
<li class="toctree-l1"><a class="reference internal" href="reading_diagrams.html">Diagrams</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Comprehensive</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comprehensive-with-instrumentation">Comprehensive with Instrumentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="thread_safe_attributes.html">Thread Safe Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="scribbleexample.html">Hacking to Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="interactingcharts.html">Interacting Statecharts (Same Machine)</a></li>
<li class="toctree-l2"><a class="reference internal" href="towardsthefactoryexample.html">Using and Unwinding a Factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="othogonalregions.html">Orthogonal Regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="batterychargingexample.html">Distributed Battery Charging</a></li>
<li class="toctree-l2"><a class="reference internal" href="cellular_automata.html">Cellular Automata</a></li>
<li class="toctree-l2"><a class="reference internal" href="i_mongol_example.html">Mongol Horse Archer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="reflection.html">Reflection</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns.html">Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
</ul>

        
        
<h2 class="sidebar-heading">Useful Links</h2>

<ul>
  <li><a href="https://github.com/aleph2c/py-activeobject">miros on github</a></li>
  <li><a href="https://github.com/aleph2c/sequence">sequence on github</a></li>
  <li><a href="https://aleph2c.github.io/miros-rabbitmq/index.html">miros-rabbitmq plugin</a></li>
  <li><a href="http://www.umlet.com">UMLet Download</a></li>
  <li><a href="http://www.inf.ed.ac.uk/teaching/courses/seoc/2005_2006/resources/statecharts.pdf">formalism explained</a></li>
</ul>


<h2 class="sidebar-heading">For Embedded</h2>

<ul>
  <li><a href="https://state-machine.com/">Quantum Leaps for Embedded</a></li>
  <li><a href="https://github.com/QuantumLeaps/">Quantum Leaps On Github</a></li>
</ul>


<h2 class="sidebar-heading">Statechart Videos</h2>

<ul>
  <li><a href="https://www.mathworks.com/videos/understanding-state-machines-what-are-they-1-of-4-90488.html">Part 1 (What)</a></li>
  <li><a href="https://www.mathworks.com/videos/understanding-state-machines-why-use-them-2-of-4-90489.html">Part 2 (Why)</a></li>
  <li><a href="https://www.mathworks.com/videos/understanding-state-machines-what-are-they-1-of-4-90488.html">Part 3 (Mealy/Moore)</a></li>
  <li><a href="https://www.mathworks.com/videos/understanding-state-machines-harel-state-machines-4-of-4-90491.html">Part 4 (Harel Statecharts)</a></li>
  <li><a href="https://barrgroup.com/Embedded-Systems/How-To/Introduction-Hierarchical-State-Machines">Introduction to HSMs</a></li>
</ul>
        
        

<div id="searchbox" style="display: none" role="search">
  <h2 id="searchlabel" class="sidebar-heading">Quick search</h2>
  <div class="searchformwrapper sidebar-content">
    <form class="search" action="search.html" method="get">
      <input class="sidebar-search sidebar-search--input" type="text" name="q" aria-labelledby="searchlabel"><input class="sidebar-search sidebar-search--btn" type="submit" value="Go">
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>

        
      </div>
      

      
      <div class="main-content main-content--sidebar">
      
        
          
  <div class="section" id="comprehensive">
<span id="comprehensive-comprehensive"></span><h1>Comprehensive<a class="headerlink" href="#comprehensive" title="Permalink to this headline">#</a></h1>
<p>Here is a statechart you can play with.  Click on the diagram to see a bigger
version of it.</p>
<p>It hasn’t been instrumented, but <code class="docutils literal notranslate"><span class="pre">write</span></code> statements have been placed all over
its HSM so you can see when events activate its different parts.</p>
<a class="reference external image-reference" href="_static/comprehensive_no_instrumentation.pdf"><img alt="_images/comprehensive_no_instrumentation.svg" class="scale-to-fit" src="_images/comprehensive_no_instrumentation.svg" /></a>
<p>The <a class="reference external" href="https://github.com/aleph2c/miros/blob/master/examples/comprehensive_no_instrumentation.py">code to interact with this design can be found here</a>,
and to run it, type:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python comprehensive_no_instrumentation.py
<span class="nv">foo</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>s-ENTRY<span class="p">;</span>s2-ENTRY<span class="p">;</span>s2-INIT<span class="p">;</span>s21-ENTRY<span class="p">;</span>s211-ENTRY<span class="p">;</span>
:C  s2-C<span class="p">;</span>s211-EXIT<span class="p">;</span>s21-EXIT<span class="p">;</span>s2-EXIT<span class="p">;</span>s1-ENTRY<span class="p">;</span>s1-INIT<span class="p">;</span>s11-ENTRY<span class="p">;</span>
:C  s1-C<span class="p">;</span>s11-EXIT<span class="p">;</span>s1-EXIT<span class="p">;</span>s2-ENTRY<span class="p">;</span>s2-INIT<span class="p">;</span>s21-ENTRY<span class="p">;</span>s211-ENTRY<span class="p">;</span>
:G  s21-G<span class="p">;</span>s211-EXIT<span class="p">;</span>s21-EXIT<span class="p">;</span>s2-EXIT<span class="p">;</span>s1-ENTRY<span class="p">;</span>s11-ENTRY<span class="p">;</span>
:E  s-E<span class="p">;</span>s11-EXIT<span class="p">;</span>s1-EXIT<span class="p">;</span>s1-ENTRY<span class="p">;</span>s11-ENTRY<span class="p">;</span>
:D  s1-D<span class="p">;</span><span class="nv">foo</span> <span class="o">=</span> <span class="m">1</span><span class="p">;</span>s11-EXIT<span class="p">;</span>s1-EXIT<span class="p">;</span>s-INIT<span class="p">;</span>s1-ENTRY<span class="p">;</span>s11-ENTRY<span class="p">;</span>
:D  s11-D<span class="p">;</span><span class="nv">foo</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>s11-EXIT<span class="p">;</span>s1-INIT<span class="p">;</span>s11-ENTRY<span class="p">;</span>
:T
Terminating
</pre></div>
</div>
</div>
<div class="section" id="comprehensive-with-instrumentation">
<h1>Comprehensive with Instrumentation<a class="headerlink" href="#comprehensive-with-instrumentation" title="Permalink to this headline">#</a></h1>
<p>It’s inconvenient to leave <code class="docutils literal notranslate"><span class="pre">write</span></code> statements all over your code while you
troubleshoot it, so miros comes with two different types of instrumentation
built in.  The instrumentation allows you to query the chart as if the write
statements were written on every transition and hook.</p>
<p>To enable this instrumentation, you place the <code class="docutils literal notranslate"><span class="pre">spy_on</span></code> decorator above your
state call back functions.</p>
<p>Here is another design (click on it to see a bigger version of it), containing
the same comprehensive chart described in the previous section, but with an
additional <code class="docutils literal notranslate"><span class="pre">M</span></code> signal.  The <code class="docutils literal notranslate"><span class="pre">M</span></code> signal causes the chart to switch from
<code class="docutils literal notranslate"><span class="pre">normal</span></code> to <code class="docutils literal notranslate"><span class="pre">trace</span></code> to <code class="docutils literal notranslate"><span class="pre">spy</span></code> and back to <code class="docutils literal notranslate"><span class="pre">normal</span></code> mode.</p>
<a class="reference external image-reference" href="_static/comprehensive_with_instrumentation.pdf"><img alt="_images/comprehensive_with_instrumentation.svg" class="scale-to-fit" src="_images/comprehensive_with_instrumentation.svg" /></a>
<p>In <code class="docutils literal notranslate"><span class="pre">normal</span></code> mode, the write statements work as they did in the previous
un-instrumented design.  In <code class="docutils literal notranslate"><span class="pre">trace</span></code> mode the trace instrumentation is shown
after your chart reacts to an event and the <code class="docutils literal notranslate"><span class="pre">write</span></code> methods are muted, so
nothing is printed to the screen.  In <code class="docutils literal notranslate"><span class="pre">spy</span></code> mode the <code class="docutils literal notranslate"><span class="pre">write</span></code> methods write
their contents into the <code class="docutils literal notranslate"><span class="pre">spy</span></code> stream then the full <code class="docutils literal notranslate"><span class="pre">spy</span></code> instrumentation is
shown after the chart reacts to an event.</p>
<p>The design was also adjusted to include the <code class="docutils literal notranslate"><span class="pre">T</span></code>, terminate event within the
<code class="docutils literal notranslate"><span class="pre">model_control</span></code> statemachine managing the instrumentation mode of the chart.
At any time you can terminate the program by sending a <code class="docutils literal notranslate"><span class="pre">T</span></code> event.</p>
<p>The <a class="reference external" href="https://github.com/aleph2c/miros/blob/master/examples/comprehensive.py">code to interact with this design can be found here</a>, and
to run it, type:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span> python comprehensive.py

 <span class="nv">foo</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>s-ENTRY<span class="p">;</span>s2-ENTRY<span class="p">;</span>s2-INIT<span class="p">;</span>s21-ENTRY<span class="p">;</span>s211-ENTRY<span class="p">;</span>
 n:C  s2-C<span class="p">;</span>s211-EXIT<span class="p">;</span>s21-EXIT<span class="p">;</span>s2-EXIT<span class="p">;</span>s1-ENTRY<span class="p">;</span>s1-INIT<span class="p">;</span>s11-ENTRY<span class="p">;</span>
 n:D  s1-D<span class="p">;</span><span class="nv">foo</span> <span class="o">=</span> <span class="m">1</span><span class="p">;</span>s11-EXIT<span class="p">;</span>s1-EXIT<span class="p">;</span>s-INIT<span class="p">;</span>s1-ENTRY<span class="p">;</span>s11-ENTRY<span class="p">;</span>
 n:D  s11-D<span class="p">;</span><span class="nv">foo</span> <span class="o">=</span> <span class="m">0</span><span class="p">;</span>s11-EXIT<span class="p">;</span>s1-INIT<span class="p">;</span>s11-ENTRY<span class="p">;</span>
<span class="hll"> n:M
</span> t:C  <span class="o">[</span><span class="m">2019</span>-02-26 <span class="m">07</span>:05:02.937057<span class="o">]</span> <span class="o">[</span>me<span class="o">]</span> e-&gt;C<span class="o">()</span> s11-&gt;s211
 t:C  <span class="o">[</span><span class="m">2019</span>-02-26 <span class="m">07</span>:05:04.933100<span class="o">]</span> <span class="o">[</span>me<span class="o">]</span> e-&gt;C<span class="o">()</span> s211-&gt;s11
<span class="hll"> t:M
</span> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 M:s11
 M:s1
 M:s
 write<span class="o">(</span><span class="s1">&#39;s-M&#39;</span><span class="o">)</span>
 M:s:HOOK
 &lt;- Queued:<span class="o">(</span><span class="m">0</span><span class="o">)</span> Deferred:<span class="o">(</span><span class="m">0</span><span class="o">)</span>
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 s:I
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 I:s11
 I:s1
 I:s
 write<span class="o">(</span><span class="s1">&#39;s-I&#39;</span><span class="o">)</span>
 I:s:HOOK
 &lt;- Queued:<span class="o">(</span><span class="m">0</span><span class="o">)</span> Deferred:<span class="o">(</span><span class="m">0</span><span class="o">)</span>
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
 s:T  Terminating
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Mode changes are highlighted.</p>
</div>
<p>The design uses the orthogonal component pattern to build an HSM within an HSM;
the <code class="docutils literal notranslate"><span class="pre">mode_control</span></code> is built in the entry condition of the <code class="docutils literal notranslate"><span class="pre">s</span></code> state, and its
events are dispatched to it using the <code class="docutils literal notranslate"><span class="pre">M</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code> hooks of the <code class="docutils literal notranslate"><span class="pre">s</span></code> state.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">post_action</span></code> method of the HsmTester thread is controlled by the
<code class="docutils literal notranslate"><span class="pre">mode_control</span></code> state, as is the <code class="docutils literal notranslate"><span class="pre">write</span></code> method of the ExampleStateChart.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">I</span></code> event is an example of the ultimate hook pattern, and pay special
attention to how <code class="docutils literal notranslate"><span class="pre">D</span></code> behaves while in the <code class="docutils literal notranslate"><span class="pre">s11</span></code> state.</p>
</div>


        
        <div class="main-content__right-sidebar">
          <h2 class="sidebar-heading">On this page:</h2>
        </div>
      </div>
    </main>

    <div class="footer-wrapper">
      
      <footer class="main-footer main-footer--sidebar">
      
        <div class="relational-links">
          <div>
            
            ← <a class="relational-link" href="examples.html" title="previous chapter">Examples</a>
            
          </div>
          <div>
            
             <a class="relational-link" href="thread_safe_attributes.html" title="next chapter">Thread Safe Attributes</a> →
            
          </div>
        </div>
        
        <div class="copyright">
          © Copyright <span class="js-year"></span>,
          
          <a href="https://github.com/aleph2c" class="copyright_link">Scott Volk</a>.
          
        </div>
        
        
        <div class="last-updated">
          <span class="prefix">Last updated:</span>
          <span class="time">Nov 03, 2020 8:22 AM</span>
        </div>
        
        
        <div class="created-with">
          Created using <a href="http://sphinx-doc.org/" class="copyright_link">Sphinx</a> 3.3.0 with <span class="theme">13ds_theme_one</span>.
        </div>
        
      </footer>
    </div>
  </body>
</html>